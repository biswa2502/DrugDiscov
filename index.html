<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="google-site-verification" content="_JuayPBca0GkckY0WNt4DAmApNvlCrYQ51D4_sGP99I" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Advanced computational platform for plant-based antipyretic drug discovery. Screen phytocompounds using ADMET profiling, toxicity prediction, and drug-likeness scoring from 15+ medicinal plants.">
    <!-- Updated Title -->
    <title>DrugDiscovery 2.1 - Phytocompound Pipeline</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* High Contrast Scientific Palette */
            --primary-blue: #0369a1;       /* darker shade of blue (Sky 600) for better text readability */
            --secondary-blue: #1589af;     
            --dark-blue: #020617;          /* Almost Black (Slate 950) - For Headings */
            --accent-cyan: #0891b2;        /* Darker Cyan */
            
            /* Glassmorphism Variables */
            --glass-bg: rgba(255, 255, 255, 0.7);
            --glass-border: rgba(255, 255, 255, 0.65); /* Increased visibility */
            --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
            --blur-amount: 12px;

            /* Backgrounds */
            --bg-body: #f0f9ff;
            --white: #ffffff;
            --light-gray: #f1f5f9;         /* Slightly darker gray background for inputs */
            
            /* High Contrast Text */
            --text-main: #0f172a;          /* Deep Slate for body text */
            --text-muted: #334155;         /* Dark Gray for secondary text (was too light before) */
            
            /* Status Colors */
            --success-green: #15803d;      /* Darker Green for readability */
            --warning-orange: #b45309;     /* Darker Orange */
            --danger-red: #b91c1c;         /* Darker Red */
        }

        body {
            font-family: 'Inter', sans-serif;
            /* Base: slightly deeper cool gray */
            background-color: #eef2f6; 
            /* THE UPGRADE: Stronger, Deeper Gradients */
            background-image: 
                /* Top Left: Vibrant Blue */
                radial-gradient(circle at 0% 0%, rgba(37, 99, 235, 0.25) 0%, transparent 50%),
                /* Top Right: Cyan/Teal */
                radial-gradient(circle at 100% 0%, rgba(6, 182, 212, 0.25) 0%, transparent 50%),
                /* Bottom Center: Soft Indigo */
                radial-gradient(circle at 50% 100%, rgba(99, 102, 241, 0.2) 0%, transparent 50%);
            background-attachment: fixed;
            color: var(--dark-blue);
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
            
        }

        /* The canvas for the molecular background */
        #molecular-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1; /* Sends it behind everything */
            pointer-events: none; /* Lets you click through it */
        }

       .main-container {
            max-width: 1400px;
            margin: 40px auto;
            
            /* THE UPGRADE: Linear Gradient Shine */
            /* Top-left is solid (shine), Bottom-right is clear (frost) */
            background: linear-gradient(
                135deg, 
                rgba(255, 255, 255, 0.9) 0%, 
                rgba(255, 255, 255, 0.6) 100%
            );
            
            /* Heavy Blur */
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            
            /* Diamond-like Border */
            border: 1px solid rgba(255, 255, 255, 0.9);
            border-bottom: 1px solid rgba(255, 255, 255, 0.4);
            
            /* 3D Float Shadow */
            box-shadow: 
                0 25px 50px -12px rgba(15, 23, 42, 0.15), 
                0 0 0 1px rgba(255, 255, 255, 0.5);
                
            border-radius: 24px;
            overflow: hidden;
            animation: fadeIn 0.8s cubic-bezier(0.2, 0.8, 0.2, 1);
            position: relative;
            z-index: 1;
            padding-top: 0;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Header */
        /* MODERN NAVBAR STYLES */
        .navbar {
            position: sticky;
            top: 0;
            z-index: 1000; /* Stays on top of everything */
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 40px;
            
            /* Glassmorphism */
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 4px 20px -5px rgba(0, 0, 0, 0.05);
            
            /* Layout constraints */
            width: 100%;
            margin-bottom: 30px;
        }

        /* Branding (Left Side) */
        .nav-brand {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .brand-icon {
            font-size: 36px; /* Larger icon to match the text */
            color: var(--primary-blue);
            background: rgba(14, 165, 233, 0.1);
            padding: 10px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .brand-text {
            display: flex;
            flex-direction: column;
        }

        .brand-title {
            font-size: 2.2em; /* Was 1.4em - Now it pops */
            font-weight: 800; /* Extra bold */
            color: var(--dark-blue);
            letter-spacing: -1px; /* Tighter tracking for a modern look */
            line-height: 1;
        }

        .brand-tagline {
            font-size: 0.85em; /* Slightly larger for readability */
            color: var(--primary-blue); /* Changed to Blue to make it stand out */
            letter-spacing: 2px;
            text-transform: uppercase;
            margin-top: 6px;
            font-weight: 600;
        }

        /* Navigation Links (Right Side) */
        .nav-menu {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        /* The Link Item */
        .nav-link {
            background: transparent;
            border: none;
            padding: 10px 18px;
            border-radius: 50px; /* Pill Shape */
            color: var(--text-muted);
            font-family: 'Inter', sans-serif;
            font-weight: 500;
            font-size: 0.95em;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-link i {
            font-size: 1.1em;
            margin-bottom: 2px; /* Visual alignment */
        }

        .nav-link:hover {
            background: rgba(14, 165, 233, 0.05);
            color: var(--primary-blue);
        }

        /* Active State (The Blue Pill) */
        .nav-link.active {
            background: rgba(14, 165, 233, 0.1);
            color: var(--primary-blue);
            font-weight: 600;
        }
        
        /* Responsive Mobile Tweaks */
        @media (max-width: 1100px) {
            .navbar { flex-direction: column; gap: 15px; padding: 15px 20px; }
            .nav-menu { flex-wrap: wrap; justify-content: center; }
            .brand-tagline { display: none; } /* Simplify for mobile */
        }

        .nav-tab.active::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--primary-blue);
        }

        /* Content Sections */
        .content-section {
            display: none;
            padding: 40px;
            animation: slideIn 0.4s ease;
        }

        .content-section.active {
            display: block;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        /* Search Bar - NEW */
        .search-container {
            margin: 20px 0;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 18px 50px 18px 25px;
            /* Glass Background */
            background: rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(4px);
            border: 1px solid rgba(14, 165, 233, 0.2);
            border-radius: 16px;
            font-size: 1.05em;
            color: var(--dark-blue);
            transition: all 0.3s ease;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.02);
        }

        .search-input:focus {
            background: rgba(255, 255, 255, 0.9);
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 4px rgba(14, 165, 233, 0.15);
            outline: none;
        }

        .search-icon {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-gray);
            font-size: 1.2em;
        }

        /* Filter Presets - NEW */
        .filter-presets {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .preset-btn {
            padding: 10px 20px;
            border: 2px solid var(--border-gray);
            border-radius: 8px;
            background: var(--white);
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            color: var(--text-dark);
        }

        .preset-btn:hover {
            border-color: var(--secondary-blue);
            background: var(--light-blue);
        }

        .preset-btn.active {
            background: var(--secondary-blue);
            color: var(--white);
            border-color: var(--secondary-blue);
        }

        /* Plant Selection */
        .plant-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

       .plant-card {
            background: var(--white);
            border: 1px solid rgba(226, 232, 240, 0.8);
            border-radius: 16px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        }

        .plant-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, var(--secondary-blue), var(--primary-blue));
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .plant-card:hover {
            transform: translateY(-5px) scale(1.03);
            box-shadow: 0 10px 30px rgba(30,64,175,0.15);
            border-color: var(--secondary-blue);
        }

        .plant-card:hover::before {
            transform: scaleX(1);
        }

        .plant-card.selected {
            border-color: var(--primary-blue);
            background: var(--light-blue);
            box-shadow: 0 10px 30px rgba(30,64,175,0.2);
        }

        .plant-name {
            font-size: 1.2em;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 8px;
        }

        .plant-scientific {
            font-style: italic;
            color: var(--text-gray);
            font-size: 0.95em;
        }

        .plant-compound-count {
            margin-top: 10px;
            padding: 5px 10px;
            background: var(--light-blue);
            border-radius: 5px;
            font-size: 0.85em;
            color: var(--primary-blue);
            font-weight: 600;
        }

        .loading-screen {
            display: none;
            text-align: center;
            padding: 60px;
        }

        .loading-screen.active {
            display: block;
        }

        .spinner {
            width: 80px;
            height: 80px;
            border: 8px solid var(--light-blue);
            border-top: 8px solid var(--primary-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 30px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Filter Controls */
        .filter-section {
            background: var(--light-gray);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .filter-group {
            margin-bottom: 25px;
        }

        .filter-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            font-weight: 600;
            color: var(--text-dark);
        }

        .filter-value {
            color: var(--primary-blue);
            font-size: 0.95em;
        }

        .slider {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: var(--border-gray);
            outline: none;
            -webkit-appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--secondary-blue);
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }

        .slider::-webkit-slider-thumb:hover {
            background: var(--primary-blue);
            transform: scale(1.15);
        }

        .toggle-switch {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 32px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .switch-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }

        .switch-slider:before {
            position: absolute;
            content: "";
            height: 24px;
            width: 24px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .switch-slider {
            background-color: var(--secondary-blue);
        }

        input:checked + .switch-slider:before {
            transform: translateX(28px);
        }

       .stats-box {
            background: var(--white);
            border-radius: 16px;
            padding: 25px;
            text-align: center;
            border: 1px solid rgba(226, 232, 240, 0.8); /* Subtle border */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05); /* Lifted effect */
            transition: all 0.3s ease;
        }

        .stats-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            border-color: var(--secondary-blue);
        }

        .stats-number {
            font-size: 2.5em;
            font-weight: 700;
            color: var(--primary-blue);
            margin-bottom: 5px;
        }

        .stats-label {
            color: var(--text-gray);
            font-size: 0.9em;
        }

        /* Chart Container */
        .chart-container {
            background: var(--white);
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
            border: 2px solid var(--border-gray);
            min-height: 300px;
        }

        /* Virtual Scroll Container - NEW */
        .virtual-scroll-container {
            height: 600px;
            overflow-y: auto;
            border: 2px solid var(--border-gray);
            border-radius: 12px;
            background: var(--white);
        }

        /* Results Table */
        .results-table {
            width: 100%;
            border-collapse: separate; /* Allows border radius */
            border-spacing: 0;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 16px;
            overflow: hidden;
            border: 1px solid rgba(14, 165, 233, 0.1);
        }

       .results-table th {
            /* Glass Header */
            background: rgba(2, 132, 199, 0.95);
            color: var(--white);
            padding: 20px;
            text-align: left;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.85em;
            letter-spacing: 1px;
            border-bottom: 2px solid rgba(255,255,255,0.1);
        }

        .results-table td {
            padding: 18px 20px;
            border-bottom: 1px solid rgba(14, 165, 233, 0.08);
            color: var(--text-main);
            font-size: 0.95em;
        }

        .results-table tr:last-child td {
            border-bottom: none;
        }

        .results-table tr:hover {
            background: rgba(14, 165, 233, 0.05); /* Subtle blue highlight */
        }

        .badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .badge.active {
            background: #dcfce7;
            color: #166534;
        }

        .badge.inactive {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .table-responsive-container {
            width: 100%;
            overflow-x: auto;
        }

      .btn {
            padding: 14px 32px;
            border: none;
            border-radius: 50px; /* Pill Shape */
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-transform: uppercase;
            letter-spacing: 1px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            justify-content: center;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-blue), var(--accent-cyan));
            color: var(--white);
            box-shadow: 0 10px 20px -5px rgba(14, 165, 233, 0.4); /* Blue Glow */
            border: 1px solid rgba(255,255,255,0.2);
        }

        .btn-primary:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 15px 30px -5px rgba(14, 165, 233, 0.6);
        }

        /* Info Section */
       .info-box {
            background: rgba(14, 165, 233, 0.08); /* Very faint primary blue */
            border-left: 4px solid var(--primary-blue);
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            border: 1px solid rgba(14, 165, 233, 0.1);
        }

        .info-title {
            font-weight: 600;
            color: var(--primary-blue);
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        /* Updated Pipeline Flow - Grid Layout */
        .process-flow {
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 25px;
            margin: 40px 0;
        }

        /* The Step Card - Glassy & Scientific Tiles */
        .process-step {
            background: linear-gradient(145deg, #ffffff, #f0f9ff); /* Subtle gradient */
            padding: 30px 20px;
            border-radius: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.8);
            /* Depth Shadows */
            box-shadow: 
                0 4px 6px -1px rgba(0, 0, 0, 0.05), 
                0 2px 4px -1px rgba(0, 0, 0, 0.03),
                inset 0 2px 4px rgba(255, 255, 255, 0.5); /* Inner shine */
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        /* Hover Effect - Lift the tile */
        .process-step:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px -5px rgba(14, 165, 233, 0.15); /* Blue glow */
            border-color: var(--secondary-blue);
        }

        /* REMOVED: The clumsy text arrows (::after) are gone */
        .process-step::after {
            content: none;
        }

        /* The Number Bubble - Popping Blue Circle */
        .step-number {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-blue));
            color: var(--white);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            font-weight: 700;
            font-size: 1.2em;
            box-shadow: 0 4px 10px rgba(14, 165, 233, 0.4); /* Glowing Shadow */
            border: 2px solid rgba(255, 255, 255, 0.4);
        }
        
        /* Text Label Styling */
        .process-step strong {
            color: var(--dark-blue);
            font-size: 1.1em;
            letter-spacing: 0.5px;
        }

        /* Footer */
        .footer {
            background: var(--light-gray);
            padding: 30px;
            text-align: center;
            border-top: 3px solid var(--primary-blue);
        }

        .footer-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .developer-info {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--border-gray);
            color: var(--text-gray);
        }

        .developer-info strong {
            color: var(--primary-blue);
        }

        .radio-group {
            display: flex;
            gap: 25px;
            align-items: center;
        }
        .radio-group label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            font-size: 0.95em;
            color: var(--text-dark);
        }
        .radio-group input[type="radio"] {
            accent-color: var(--primary-blue);
            width: 18px;
            height: 18px;
        }

        .pagination-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-top: 25px;
        }
        
        .page-info {
            font-weight: 600;
            color: var(--text-dark);
        }

        /* Comparison Panel - NEW */
        .comparison-panel {
            background: var(--white);
            border: 2px solid var(--border-gray);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .comparison-item {
            padding: 15px;
            background: var(--light-blue);
            border-radius: 8px;
            position: relative;
        }

        .comparison-remove {
            position: absolute;
            top: 5px;
            right: 5px;
            background: var(--danger-red);
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            cursor: pointer;
            font-size: 0.8em;
        }

        /* Progress Bar - NEW */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--border-gray);
            border-radius: 10px;
            overflow: hidden;
            margin: 15px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--secondary-blue), var(--success-green));
            transition: width 0.3s ease;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }
            
            .plant-grid {
                grid-template-columns: 1fr;
            }

            .nav-tab {
                font-size: 0.9em;
                padding: 15px 10px;
            }

            .process-step::after {
                display: none;
            }
            
            .filter-presets {
                flex-direction: column;
            }
            
            .preset-btn {
                width: 100%;
            }
        }

        /* Advanced Filters Panel - NEW */
        .advanced-filters {
            background: var(--white);
            border: 2px solid var(--border-gray);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            display: none;
        }

        .advanced-filters.active {
            display: block;
        }

        .toggle-advanced {
            display: inline-block;
            margin: 15px 0;
            color: var(--secondary-blue);
            cursor: pointer;
            font-weight: 600;
        }

        .toggle-advanced:hover {
            text-decoration: underline;
        }
        /* --- STEP 4: HIGH CONTRAST CONTAINERS --- */
        
        /* 1. The Big Containers (Filters, Charts, Lists) */
        .filter-section, 
        .chart-container, 
        .virtual-scroll-container, 
        .comparison-panel,
        .advanced-filters {
            /* Gradient: White at top -> Faint Blue at bottom */
            background: linear-gradient(180deg, #ffffff 0%, #f8fafc 100%) !important;
            
            /* Stronger Border so you can see the edges */
            border: 1px solid #cbd5e1 !important; 
            
            /* 3D Shadow to lift it off the page */
            box-shadow: 
                0 4px 6px -1px rgba(0, 0, 0, 0.05),
                0 2px 4px -1px rgba(0, 0, 0, 0.03),
                inset 0 2px 0 rgba(255, 255, 255, 1) !important;
                
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
        }

        /* 2. The Small Stats Boxes (Numbers) */
        .stats-box {
            background: linear-gradient(145deg, #ffffff, #f1f5f9) !important;
            border: 1px solid #cbd5e1 !important;
            border-bottom: 3px solid #cbd5e1 !important; /* Thicker bottom looks like a button */
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05) !important;
        }
    </style>
   <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@phosphor-icons/web"></script> 
</head>
<body>
    <canvas id="molecular-canvas"></canvas>
    <div class="main-container">
        <!-- Header -->
       <nav class="navbar">
            <div class="nav-brand">
                <div class="brand-icon">
                    <i class="ph-fill ph-flask"></i>
                </div>
                <div class="brand-text">
                    <span class="brand-title">DrugDiscovery 2.1</span>
                    <span class="brand-tagline">In Silico Pipeline</span>
                </div>
            </div>

            <div class="nav-menu">
                <button class="nav-link nav-tab active" data-section="home">
                    <i class="ph ph-house"></i> Home
                </button>
                <button class="nav-link nav-tab" data-section="select">
                    <i class="ph ph-plant"></i> Select Plant
                </button>
                <button class="nav-link nav-tab" data-section="explore">
                    <i class="ph ph-flask"></i> Explore Data
                </button>
                <button class="nav-link nav-tab" data-section="screen">
                    <i class="ph ph-lightning"></i> Screen
                </button>
                <button class="nav-link nav-tab" data-section="results">
                    <i class="ph ph-chart-bar"></i> Results
                </button>
                <button class="nav-link nav-tab" data-section="guide">
                    <i class="ph ph-book-open"></i> Guide
                </button>
                <button class="nav-link nav-tab" data-section="about">
                    <i class="ph ph-info"></i> About
                </button>
            </div>
        </nav>

        <!-- Home Section -->
        <div id="home-section" class="content-section active">
            <h2 style="color: var(--primary-blue); margin-bottom: 20px;">Welcome to Plant-Based Drug Discovery</h2>
            
            <div class="info-box">
                <div class="info-title"> Project Overview</div>
                <p>This enhanced web tool provides an integrated platform for discovering potential compounds from medicinal plants. Our optimized database is designed to handle thousands of compounds per plant with advanced filtering, search, and visualization capabilities.</p>
            </div>

            <h3 style="margin: 30px 0 20px; color: var(--text-dark);"> The Discovery Pipeline</h3>
            <div class="process-flow">
                <div class="process-step">
                    <div class="step-number">1</div>
                    <strong>Plant Selection</strong>
                </div>
                <div class="process-step">
                    <div class="step-number">2</div>
                    <strong>Explore Data</strong>
                </div>
                <div class="process-step">
                    <div class="step-number">3</div>
                    <strong>Screening</strong>
                </div>
                <div class="process-step">
                    <div class="step-number">4</div>
                    <strong>Results</strong>
                </div>
            </div>

            
            <h3 style="margin: 30px 0 20px; color: var(--text-dark);"> Data Sources</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                <div class="stats-box">
                    <div class="stats-number">15</div>
                    <div class="stats-label">Medicinal Plants</div>
                </div>
                <div class="stats-box">
                    <div class="stats-number">10,000+</div>
                    <div class="stats-label">Phytochemicals (Capacity)</div>
                </div>
                <div class="stats-box">
                    <div class="stats-number">12</div>
                    <div class="stats-label">Properties Analyzed</div>
                </div>
                <div class="stats-box">
                    <div class="stats-number">5</div>
                    <div class="stats-label">Toxicity Parameters</div>
                </div>
            </div>

            <div style="text-align: center; margin-top: 40px;">
<button class="btn btn-primary" onclick="startDiscovery()"> Start Discovery</button>            </div>
        </div>

        <!-- Plant Selection Section -->
        <div id="select-section" class="content-section">
            <h2 style="color: var(--primary-blue); margin-bottom: 20px;">üåø Select Medicinal Plant</h2>
            
            <div class="info-box">
                <div class="info-title">Instructions</div>
                <p>Select a plant to view its phytochemical database. Each plant can contain thousands of compounds with comprehensive ADMET profiling. The system is optimized to handle large datasets efficiently.</p>
            </div>

            <!-- Search Bar -->
            <div class="search-container">
                <input type="text" class="search-input" id="plantSearch" placeholder="Search plants by name or common name..." oninput="filterPlants()">
                <span class="search-icon">üîç</span>
            </div>

            <div class="plant-grid" id="plantGrid"></div>

            <div class="loading-screen" id="loadingScreen">
                <div class="spinner"></div>
                <h3 style="color: var(--primary-blue);">Processing Phytochemical Data...</h3>
                <p style="color: var(--text-gray); margin-top: 10px;">Loading and indexing compound database</p>
                <div class="progress-bar" style="max-width: 400px; margin: 20px auto;">
                    <div class="progress-fill" id="loadingProgress" style="width: 0%"></div>
                </div>
            </div>
        </div>
        
        <!-- Explore Data Section -->
        <div id="explore-section" class="content-section">
            <h2 style="color: var(--primary-blue); margin-bottom: 20px;">üî¨ Explore Phytochemical Data</h2>
             <div class="info-box">
                <div class="info-title">Complete Dataset with Advanced Features</div>
                <p>Browse all compounds with real-time search, sorting, and filtering. Click on any compound for detailed information.</p>
            </div>

            <!-- Search and Filters -->
            <div class="search-container">
                <input type="text" class="search-input" id="compoundSearch" placeholder="Search by compound name, CID, formula, or SMILES..." oninput="searchCompounds()">
                <span class="search-icon">üîç</span>
            </div>

             <div style="background: var(--white); border-radius: 15px; padding: 25px; border: 2px solid var(--border-gray); margin: 20px 0;">
                <h3 style="color: var(--text-dark); margin-bottom: 15px;">Selected Plant: <span id="explorePlantName" style="color: var(--secondary-blue);">-</span></h3>
                <div style="display: flex; gap: 30px; flex-wrap: wrap;">
                    <p><strong>Total Compounds:</strong> <span id="exploreTotalCompounds" style="font-weight: bold; color: var(--primary-blue);">0</span></p>
                    <p><strong>Search Results:</strong> <span id="exploreSearchResults" style="font-weight: bold; color: var(--success-green);">0</span></p>
                </div>
            </div>
            
            <div id="exploreTableContainer" class="table-responsive-container"></div>

            <div class="pagination-controls" id="paginationControls">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span style="color: var(--text-dark); font-weight: 600;">Rows per page:</span>
                    <select id="rowsPerPageSelect" onchange="changeRowsPerPage()" 
                            style="padding: 8px 12px; border: 2px solid var(--border-gray); border-radius: 8px; font-size: 0.9em; cursor: pointer;">
                        <option value="10">10</option>
                        <option value="50" selected>50</option>
                        <option value="100">100</option>
                    </select>
                </div>
                
                <span class="page-info" id="pageInfo">Page 1 of 1</span>
                <span class="page-info" id="rowRangeInfo" style="color: var(--text-gray);"></span>
                
                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-secondary btn-sm" id="prevPageBtn" onclick="prevPage()">¬´ Previous</button>
                    <button class="btn btn-secondary btn-sm" id="nextPageBtn" onclick="nextPage()">Next ¬ª</button>
                </div>
            </div>
            
             <div style="text-align: center; margin-top: 40px;">
    <button class="btn btn-secondary" onclick="navigateToSection('select')" style="margin-right: 15px;">‚Üê Change Plant</button>
    <button class="btn btn-primary" onclick="proceedToScreening()">Proceed to Screening ‚Üí</button>
</div>
        </div>

        <!-- Screening Section -->
        <div id="screen-section" class="content-section">
            <h2 style="color: var(--primary-blue); margin-bottom: 20px;">‚ö° Interactive Compound Screening</h2>
            
            <div class="info-box">
                <div class="info-title">Screening Criteria with Smart Presets</div>
                <p>Use filter presets for quick screening or customize parameters manually. Real-time filtering shows you potential drug candidates instantly.</p>
            </div>

            <!-- Filter Presets -->
            <div class="filter-presets">
                <button class="preset-btn" onclick="applyPreset('permissive')">üü¢ Permissive</button>
                <button class="preset-btn active" onclick="applyPreset('moderate')">üü° Moderate (Default)</button>
                <button class="preset-btn" onclick="applyPreset('strict')">üî¥ Strict</button>
                <button class="preset-btn" onclick="applyPreset('custom')">‚öôÔ∏è Custom</button>
            </div>

            <div class="filter-section">
                <h3 style="margin-bottom: 25px; color: var(--text-dark);"> ADME & Drug-Likeness Properties</h3>
                
                <div class="filter-group">
    <div class="filter-label">
        <span>1. Bioavailability Score</span>
        <span class="filter-value" id="bioValue">‚â• 0.55 (Fixed)</span>
    </div>
    <p style="font-size: 0.9em; color: var(--text-gray); margin-top: 5px;">Compounds must have bioavailability ‚â• 0.55. Scores closer to 1 indicate better absorption potential.</p>
</div>

               <div class="filter-group">
    <div class="filter-label">
        <span>2. Blood-Brain Barrier (BBB) Permeability</span>
    </div>
     <div class="radio-group">
        <label><input type="radio" name="bbb" value="yes" onchange="updateFilters()"> Yes</label>
        <label><input type="radio" name="bbb" value="no" onchange="updateFilters()" checked> No</label>
    </div>
    <p style="font-size: 0.9em; color: var(--text-gray); margin-top: 5px;">‚Ä¢ <strong>Yes</strong>: If targeting CNS conditions<br>‚Ä¢ <strong>No</strong>: Acceptable for peripheral targeting</p>
</div>

                <div class="filter-group">
    <div class="filter-label">
        <span>3. Lipinski's Rule of 5</span>
    </div>
    <p style="font-size: 0.9em; color: var(--text-gray); margin-top: 5px;">Only compounds with <strong>zero violations</strong> will pass this filter.</p>
</div>

                <div class="filter-group">
    <div class="filter-label">
        <span>4. Drug Likeness Score</span>
        <span class="filter-value" id="drugValue">‚â• 3.5 (Fixed)</span>
    </div>
    <p style="font-size: 0.9em; color: var(--text-gray); margin-top: 5px;">Compounds must have drug likeness score ‚â• 3.5 to pass.</p>
</div>
<h3 style="margin: 35px 0 25px; color: var(--text-dark);">‚öôÔ∏è Optional Filters (Toggle to Enable)</h3>
<p style="font-size: 0.9em; color: var(--text-gray); margin-bottom: 20px;">These filters are OFF by default. Enable them for stricter screening.</p>

<div class="filter-group">
    <div class="toggle-switch">
        <label class="switch">
            <input type="checkbox" id="mwSwitch" onchange="updateFilters()">
            <span class="switch-slider"></span>
        </label>
        <span>Molecular Weight (150-500 Da)</span>
    </div>
</div>

<div class="filter-group">
    <div class="toggle-switch">
        <label class="switch">
            <input type="checkbox" id="qedSwitch" onchange="updateFilters()">
            <span class="switch-slider"></span>
        </label>
        <span>QED Score (‚â• 0.60)</span>
    </div>
</div>

<div class="filter-group">
    <div class="toggle-switch">
        <label class="switch">
            <input type="checkbox" id="logPSwitch" onchange="updateFilters()">
            <span class="switch-slider"></span>
        </label>
        <span>LogP Value (1-3 range)</span>
    </div>
</div>

<div class="filter-group">
    <div class="toggle-switch">
        <label class="switch">
            <input type="checkbox" id="hbdSwitch" onchange="updateFilters()">
            <span class="switch-slider"></span>
        </label>
        <span>Hydrogen Bond Donors (‚â§ 5)</span>
    </div>
</div>

<div class="filter-group">
    <div class="toggle-switch">
        <label class="switch">
            <input type="checkbox" id="hbaSwitch" onchange="updateFilters()">
            <span class="switch-slider"></span>
        </label>
        <span>Hydrogen Bond Acceptors (‚â§ 10)</span>
    </div>
</div>

<h3 style="margin: 35px 0 25px; color: var(--text-dark);"> Toxicity Filters (All Must Be Inactive)</h3>
<p style="font-size: 0.9em; color: var(--text-gray); margin-bottom: 15px;">Compounds must be <strong>Inactive</strong> for all toxicity parameters to pass.</p>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                    <div class="toggle-switch">
                        <label class="switch">
                            <input type="checkbox" id="hepatoSwitch" checked onchange="updateFilters()">
                            <span class="switch-slider"></span>
                        </label>
                        <span>No Hepatotoxicity</span>
                    </div>
                    <div class="toggle-switch">
                        <label class="switch">
                            <input type="checkbox" id="carcinoSwitch" checked onchange="updateFilters()">
                            <span class="switch-slider"></span>
                        </label>
                        <span>No Carcinogenicity</span>
                    </div>
                    <div class="toggle-switch">
                        <label class="switch">
                            <input type="checkbox" id="immunoSwitch" checked onchange="updateFilters()">
                            <span class="switch-slider"></span>
                        </label>
                        <span>No Immunogenicity</span>
                    </div>
                    <div class="toggle-switch">
                        <label class="switch">
                            <input type="checkbox" id="mutagenSwitch" checked onchange="updateFilters()">
                            <span class="switch-slider"></span>
                        </label>
                        <span>No Mutagenicity</span>
                    </div>
                    <div class="toggle-switch">
                        <label class="switch">
                            <input type="checkbox" id="cytoSwitch" checked onchange="updateFilters()">
                            <span class="switch-slider"></span>
                        </label>
                        <span>No Cytotoxicity</span>
                    </div>
                </div>
            </div>

            <div style="display: flex; gap: 20px; margin: 30px 0; align-items: flex-start; flex-wrap: wrap;">
                <div class="stats-box" style="flex-basis: 220px; flex-shrink: 0;">
                    <div class="stats-number" id="totalCompounds">0</div>
                    <div class="stats-label">Total Compounds</div>
                </div>
                <div style="flex-grow: 1; display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 20px;">
                    <div class="stats-box">
                        <div class="stats-number" id="filteredCompounds">0</div>
                        <div class="stats-label">After Screening</div>
                    </div>
                    <div class="stats-box">
                        <div class="stats-number" id="successRate">0%</div>
                        <div class="stats-label">Success Rate</div>
                    </div>
                </div>
            </div>

            <div class="chart-container">
                <h3 style="margin-bottom: 20px; color: var(--text-dark);">üìà Screening Progress</h3>
                <canvas id="screeningChart" style="max-height: 250px;"></canvas>
            </div>

            <div style="text-align: center; margin-top: 40px;">
                <button class="btn btn-secondary" onclick="navigateToSection('explore')" style="margin-right: 15px;">‚Üê Back to Data</button>
                <button class="btn btn-primary" onclick="showResults()">View Results ‚Üí</button>
            </div>
        </div>

        <!-- Results Section -->
        <div id="results-section" class="content-section">
            <h2 style="color: var(--primary-blue); margin-bottom: 20px;"> Screened Compounds - Final Results</h2>
            
          <div class="info-box">
                <div class="info-title">‚úì Screening Complete</div>
                <p>Below are the phytochemicals that passed all screening criteria. These compounds show promising drug-like properties for several applications.</p>
            </div>

           <div style="background: var(--white); border-radius: 15px; padding: 25px; border: 2px solid var(--border-gray); margin: 20px 0;">
                <h3 style="color: var(--text-dark); margin-bottom: 15px;">Selected Plant: <span id="selectedPlantName" style="color: var(--secondary-blue);">-</span></h3>
                <p><strong>Compounds Screened:</strong> <span id="resultsTotal">0</span> | <strong>Passed Filters:</strong> <span id="resultsPassed" style="color: #16a34a;">0</span></p>
            </div>

            <div id="resultsTableContainer"></div>

            <div style="text-align: center; margin-top: 40px;">
                <button class="btn btn-secondary" onclick="navigateToSection('screen')" style="margin-right: 15px;">‚Üê Modify Filters</button>
                <button class="btn btn-primary" onclick="exportResults()"> Export Results (CSV)</button>
            </div>
        </div>

        <!-- Data Collection Guide Section - NEW -->
        <div id="guide-section" class="content-section">
            <h2 style="color: var(--primary-blue); margin-bottom: 20px;">üìö Comprehensive Data Collection Guide</h2>
            
            <div class="info-box">
                <div class="info-title">üéØ Purpose of This Guide</div>
                <p>This guide provides step-by-step instructions for collecting thousands of phytochemical compounds and their properties from various databases. Follow this workflow to build your complete dataset.</p>
            </div>

            <h3 style="margin: 30px 0 20px; color: var(--text-dark);">üìã Data Collection Workflow</h3>
            
            <div style="background: var(--white); border-radius: 15px; padding: 25px; border: 2px solid var(--border-gray); margin-bottom: 20px;">
                <h4 style="color: var(--secondary-blue); margin-bottom: 15px;">Step 1: Phytochemical Database Collection</h4>
                <p style="margin-bottom: 15px;"><strong>Objective:</strong> Collect compound names and basic information for each plant</p>
                
                <div style="background: var(--light-gray); padding: 20px; border-radius: 10px; margin: 15px 0;">
                    <h5 style="margin-bottom: 10px;">üåê Source 1: IMPPAT 2.0</h5>
                    <ul style="line-height: 2; margin-left: 20px;">
                        <li><strong>Website:</strong> <a href="https://cb.imsc.res.in/imppat/" target="_blank" style="color: var(--secondary-blue);">https://cb.imsc.res.in/imppat/</a></li>
                        <li><strong>Method:</strong> Search by plant scientific name</li>
                        <li><strong>Data to collect:</strong> Compound names, PubChem CID (if available)</li>
                        <li><strong>Export:</strong> Download as CSV or copy compound list</li>
                        <li><strong>Expected yield:</strong> 100-2000 compounds per plant</li>
                    </ul>
                </div>

                <div style="background: var(--light-gray); padding: 20px; border-radius: 10px; margin: 15px 0;">
                    <h5 style="margin-bottom: 10px;">üåê Source 2: KNApSAcK Family Database</h5>
                    <ul style="line-height: 2; margin-left: 20px;">
                        <li><strong>Website:</strong> <a href="http://www.knapsackfamily.com/knapsack_core/top.php" target="_blank" style="color: var(--secondary-blue);">http://www.knapsackfamily.com/</a></li>
                        <li><strong>Method:</strong> Use species search function</li>
                        <li><strong>Data to collect:</strong> Metabolite names, C_ID (KNApSAcK ID)</li>
                        <li><strong>Tip:</strong> Cross-reference with IMPPAT to avoid duplicates</li>
                        <li><strong>Expected yield:</strong> 50-500 additional compounds per plant</li>
                    </ul>
                </div>

                <div style="background: var(--light-gray); padding: 20px; border-radius: 10px; margin: 15px 0;">
                    <h5 style="margin-bottom: 10px;">üåê Source 3: Dr. Duke's Phytochemical Database</h5>
                    <ul style="line-height: 2; margin-left: 20px;">
                        <li><strong>Website:</strong> <a href="https://phytochem.nal.usda.gov/" target="_blank" style="color: var(--secondary-blue);">https://phytochem.nal.usda.gov/</a></li>
                        <li><strong>Method:</strong> Search by plant genus and species</li>
                        <li><strong>Data to collect:</strong> Chemical names, activities</li>
                        <li><strong>Note:</strong> May not provide PubChem CIDs directly</li>
                        <li><strong>Expected yield:</strong> 50-300 additional compounds per plant</li>
                    </ul>
                </div>
            </div>

            <div style="background: var(--white); border-radius: 15px; padding: 25px; border: 2px solid var(--border-gray); margin-bottom: 20px;">
                <h4 style="color: var(--secondary-blue); margin-bottom: 15px;">Step 2: Chemical Identifier Collection (PubChem)</h4>
                <p style="margin-bottom: 15px;"><strong>Objective:</strong> Get CID, SMILES, molecular formula, and weight for each compound</p>
                
                <div style="background: var(--light-gray); padding: 20px; border-radius: 10px; margin: 15px 0;">
                    <h5 style="margin-bottom: 10px;">üåê PubChem Database</h5>
                    <ul style="line-height: 2; margin-left: 20px;">
                        <li><strong>Website:</strong> <a href="https://pubchem.ncbi.nlm.nih.gov/" target="_blank" style="color: var(--secondary-blue);">https://pubchem.ncbi.nlm.nih.gov/</a></li>
                        <li><strong>Method 1 - Single compound:</strong> Search by name ‚Üí Copy CID, SMILES, Formula, MW</li>
                        <li><strong>Method 2 - Batch (Recommended):</strong> Use PubChem PUG REST API or batch search</li>
                        <li><strong>Data to collect:</strong>
                            <ul style="margin-left: 20px; margin-top: 10px;">
                                <li>PubChem CID (Compound ID)</li>
                                <li>Canonical SMILES</li>
                                <li>Molecular Formula</li>
                                <li>Molecular Weight</li>
                            </ul>
                        </li>
                    </ul>
                    
                    <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid var(--warning-orange);">
                        <strong>‚ö° Pro Tip:</strong> Use PUG REST API for batch processing:<br>
                        <code style="background: var(--white); padding: 5px; border-radius: 4px; display: inline-block; margin-top: 5px;">
                        https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/name/[compound_name]/property/MolecularFormula,MolecularWeight,CanonicalSMILES/JSON
                        </code>
                    </div>
                </div>
            </div>

            <div style="background: var(--white); border-radius: 15px; padding: 25px; border: 2px solid var(--border-gray); margin-bottom: 20px;">
                <h4 style="color: var(--secondary-blue); margin-bottom: 15px;">Step 3: ADME Properties (SwissADME)</h4>
                <p style="margin-bottom: 15px;"><strong>Objective:</strong> Calculate bioavailability score and BBB permeability</p>
                
                <div style="background: var(--light-gray); padding: 20px; border-radius: 10px; margin: 15px 0;">
                    <h5 style="margin-bottom: 10px;">üåê SwissADME</h5>
                    <ul style="line-height: 2; margin-left: 20px;">
                        <li><strong>Website:</strong> <a href="http://www.swissadme.ch/" target="_blank" style="color: var(--secondary-blue);">http://www.swissadme.ch/</a></li>
                        <li><strong>Input:</strong> SMILES strings (batch input supported - up to 100 per submission)</li>
                        <li><strong>Data to collect:</strong>
                            <ul style="margin-left: 20px; margin-top: 10px;">
                                <li><strong>Bioavailability Score:</strong> Look in "Druglikeness" section (value 0.11 to 0.85)</li>
                                <li><strong>BBB Permeability:</strong> Look in "Pharmacokinetics" section (Yes/No)</li>
                                <li><strong>Lipinski Rule:</strong> Check violations in "Druglikeness" section</li>
                            </ul>
                        </li>
                        <li><strong>Export:</strong> Download results as CSV</li>
                        <li><strong>Processing time:</strong> ~10-20 compounds per minute</li>
                    </ul>
                    
                    <div style="background: #d1ecf1; padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #0dcaf0;">
                        <strong>üìù Note:</strong> For thousands of compounds, process in batches of 100. Use a spreadsheet to track progress.
                    </div>
                </div>
            </div>

            <div style="background: var(--white); border-radius: 15px; padding: 25px; border: 2px solid var(--border-gray); margin-bottom: 20px;">
                <h4 style="color: var(--secondary-blue); margin-bottom: 15px;">Step 4: Lipinski's Rule of Five (SwissADME)</h4>
                <p style="margin-bottom: 15px;"><strong>Objective:</strong> Assess drug-likeness based on Lipinski's criteria</p>
                
                <div style="background: var(--light-gray); padding: 20px; border-radius: 10px; margin: 15px 0;">
                    <p style="margin-bottom: 10px;"><strong>Data collected from SwissADME (same as Step 3):</strong></p>
                    <ul style="line-height: 2; margin-left: 20px;">
                        <li><strong>Number of violations:</strong> 0, 1, 2, 3, 4, or 5</li>
                        <li><strong>Specific violations to note:</strong>
                            <ul style="margin-left: 20px; margin-top: 10px;">
                                <li>MW > 500 Da</li>
                                <li>MLOGP > 4.15</li>
                                <li>HBD > 5 (hydrogen bond donors)</li>
                                <li>HBA > 10 (hydrogen bond acceptors)</li>
                            </ul>
                        </li>
                        <!-- UPDATED DATA FORMAT DESCRIPTION -->
                        <li><strong>Format:</strong> "No with zero violation" = No violations (passes), "Yes with one violation", "Yes with two violations", etc. = Has violations</li>
                    </ul>
                </div>
            </div>

            <div style="background: var(--white); border-radius: 15px; padding: 25px; border: 2px solid var(--border-gray); margin-bottom: 20px;">
                <h4 style="color: var(--secondary-blue); margin-bottom: 15px;">Step 5: Drug-Likeness Score (Molsoft)</h4>
                <p style="margin-bottom: 15px;"><strong>Objective:</strong> Calculate drug-likeness score</p>
                
                <div style="background: var(--light-gray); padding: 20px; border-radius: 10px; margin: 15px 0;">
                    <h5 style="margin-bottom: 10px;">üåê Molsoft Drug-Likeness Calculator</h5>
                    <ul style="line-height: 2; margin-left: 20px;">
                        <li><strong>Website:</strong> <a href="http://www.molsoft.com/mprop/" target="_blank" style="color: var(--secondary-blue);">http://www.molsoft.com/mprop/</a></li>
                        <li><strong>Input:</strong> SMILES strings (one at a time or small batches)</li>
                        <li><strong>Data to collect:</strong> Drug-Likeness score (ranges from -5 to +5)</li>
                        <li><strong>Interpretation:</strong>
                            <ul style="margin-left: 20px; margin-top: 10px;">
                                <li>Positive values: More drug-like</li>
                                <li>Negative values: Less drug-like</li>
                                <li>Typical threshold: > 0.0 or > 0.17 for screening</li>
                            </ul>
                        </li>
                    </ul>
                    
                    <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid var(--warning-orange);">
                        <strong>‚ö†Ô∏è Note:</strong> Molsoft doesn't support batch processing. For thousands of compounds, this will be time-consuming. Consider collecting a representative sample or using alternative tools.
                    </div>
                </div>
            </div>

            <div style="background: var(--white); border-radius: 15px; padding: 25px; border: 2px solid var(--border-gray); margin-bottom: 20px;">
                <h4 style="color: var(--secondary-blue); margin-bottom: 15px;">Step 6: Toxicity Prediction (ProTox-II)</h4>
                <p style="margin-bottom: 15px;"><strong>Objective:</strong> Predict toxicity parameters for each compound</p>
                
                <div style="background: var(--light-gray); padding: 20px; border-radius: 10px; margin: 15px 0;">
                    <h5 style="margin-bottom: 10px;">üåê ProTox-II</h5>
                    <ul style="line-height: 2; margin-left: 20px;">
                        <li><strong>Website:</strong> <a href="https://tox-new.charite.de/protox_II/" target="_blank" style="color: var(--secondary-blue);">https://tox-new.charite.de/protox_II/</a></li>
                        <li><strong>Input:</strong> SMILES strings (one at a time)</li>
                        <li><strong>Data to collect (all as Active/Inactive):</strong>
                            <ul style="margin-left: 20px; margin-top: 10px;">
                                <li>Hepatotoxicity</li>
                                <li>Carcinogenicity</li>
                                <li>Immunotoxicity (Immunogenicity)</li>
                                <li>Mutagenicity</li>
                                <li>Cytotoxicity</li>
                            </ul>
                        </li>
                        <li><strong>Processing time:</strong> ~30 seconds per compound</li>
                    </ul>
                    
                    <div style="background: #f8d7da; padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid var(--danger-red);">
                        <strong>‚ö†Ô∏è Important:</strong> ProTox-II processes one compound at a time. For 1000+ compounds, this is the most time-consuming step. Budget approximately 8-10 hours per 1000 compounds. Consider using automation tools or scripts.
                    </div>
                </div>
            </div>

            <h3 style="margin: 30px 0 20px; color: var(--text-dark);">üõ†Ô∏è Data Organization Template</h3>
            
            <div style="background: var(--white); border-radius: 15px; padding: 25px; border: 2px solid var(--border-gray); margin-bottom: 20px;">
                <h4 style="color: var(--secondary-blue); margin-bottom: 15px;">Excel/CSV Template Structure</h4>
                <p style="margin-bottom: 15px;">Organize your collected data in this format:</p>
                
                <div style="overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse; font-size: 0.9em;">
                        <thead>
                            <tr style="background: var(--primary-blue); color: white;">
                                <th style="padding: 10px; border: 1px solid var(--border-gray);">Compound Name</th>
                                <th style="padding: 10px; border: 1px solid var(--border-gray);">PubChem CID</th>
                                <th style="padding: 10px; border: 1px solid var(--border-gray);">Formula</th>
                                <th style="padding: 10px; border: 1px solid var(--border-gray);">Weight</th>
                                <th style="padding: 10px; border: 1px solid var(--border-gray);">SMILES</th>
                                <th style="padding: 10px; border: 1px solid var(--border-gray);">Bioavailability</th>
                                <th style="padding: 10px; border: 1px solid var(--border-gray);">BBB</th>
                                <th style="padding: 10px; border: 1px solid var(--border-gray);">Lipinski</th>
                                <th style="padding: 10px; border: 1px solid var(--border-gray);">Drug Likeness</th>
                                <th style="padding: 10px; border: 1px solid var(--border-gray);">Hepatotoxicity</th>
                                <th style="padding: 10px; border: 1px solid var(--border-gray);">Carcinogenicity</th>
                                <th style="padding: 10px; border: 1px solid var(--border-gray);">Immunogenicity</th>
                                <th style="padding: 10px; border: 1px solid var(--border-gray);">Mutagenicity</th>
                                <th style="padding: 10px; border: 1px solid var(--border-gray);">Cytotoxicity</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="padding: 10px; border: 1px solid var(--border-gray);">Andrographolide</td>
                                <td style="padding: 10px; border: 1px solid var(--border-gray);">5318517</td>
                                <td style="padding: 10px; border: 1px solid var(--border-gray);">C20H30O5</td>
                                <td style="padding: 10px; border: 1px solid var(--border-gray);">350.45</td>
                                <td style="padding: 10px; border: 1px solid var(--border-gray); font-size: 0.75em;">CC1=C[C@@H]2...</td>
                                <td style="padding: 10px; border: 1px solid var(--border-gray);">0.55</td>
                                <td style="padding: 10px; border: 1px solid var(--border-gray);">No</td>
                                <td style="padding: 10px; border: 1px solid var(--border-gray);">No</td>
                                <td style="padding: 10px; border: 1px solid var(--border-gray);">0.42</td>
                                <td style="padding: 10px; border: 1px solid var(--border-gray);">Inactive</td>
                                <td style="padding: 10px; border: 1px solid var(--border-gray);">Inactive</td>
                                <td style="padding: 10px; border: 1px solid var(--border-gray);">Inactive</td>
                                <td style="padding: 10px; border: 1px solid var(--border-gray);">Inactive</td>
                                <td style="padding: 10px; border: 1px solid var(--border-gray);">Inactive</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <h3 style="margin: 30px 0 20px; color: var(--text-dark);">üíª Automation Scripts (Optional)</h3>
            
            <div style="background: var(--white); border-radius: 15px; padding: 25px; border: 2px solid var(--border-gray); margin-bottom: 20px;">
                <h4 style="color: var(--secondary-blue); margin-bottom: 15px;">Python Script Template for PubChem Data Collection</h4>
                <p style="margin-bottom: 15px;">Use this script to automate PubChem data retrieval:</p>
                
                <pre style="background: var(--light-gray); padding: 20px; border-radius: 10px; overflow-x: auto; font-size: 0.85em;"><code>import requests
import time
import csv

def get_pubchem_data(compound_name):
    """Fetch compound data from PubChem API"""
    base_url = "https://pubchem.ncbi.nlm.nih.gov/rest/pug"
    properties = "MolecularFormula,MolecularWeight,CanonicalSMILES"
    
    try:
        url = f"{base_url}/compound/name/{compound_name}/property/{properties}/JSON"
        response = requests.get(url)
        
        if response.status_code == 200:
            data = response.json()
            props = data['PropertyTable']['Properties'][0]
            return {
                'cid': props['CID'],
                'formula': props.get('MolecularFormula', ''),
                'weight': props.get('MolecularWeight', ''),
                'smiles': props.get('CanonicalSMILES', '')
            }
        else:
            return None
    except Exception as e:
        print(f"Error fetching {compound_name}: {e}")
        return None
    
    time.sleep(0.2)  # Rate limiting

# Example usage
compound_list = ['Andrographolide', 'Curcumin', 'Quercetin']
results = []

for compound in compound_list:
    print(f"Fetching: {compound}")
    data = get_pubchem_data(compound)
    if data:
        data['name'] = compound
        results.append(data)
        print(f"  ‚úì CID: {data['cid']}")
    else:
        print(f"  ‚úó Not found")

# Save to CSV
with open('pubchem_data.csv', 'w', newline='') as f:
    writer = csv.DictWriter(f, fieldnames=['name', 'cid', 'formula', 'weight', 'smiles'])
    writer.writeheader()
    writer.writerows(results)

print(f"\nCompleted! {len(results)} compounds saved.")
</code></pre>
            </div>

            <h3 style="margin: 30px 0 20px; color: var(--text-dark);"> Integration into HTML Application</h3>
            
            <div style="background: var(--white); border-radius: 15px; padding: 25px; border: 2px solid var(--border-gray); margin-bottom: 20px;">
                <h4 style="color: var(--secondary-blue); margin-bottom: 15px;">Converting Your Data to JavaScript Format</h4>
                <p style="margin-bottom: 15px;">Once you've collected all data in Excel/CSV, convert it to JavaScript format:</p>
                
                <div style="background: var(--light-gray); padding: 20px; border-radius: 10px;">
                    <p style="margin-bottom: 10px;"><strong>Example JavaScript Structure:</strong></p>
<pre style="background: var(--white); padding: 15px; border-radius: 8px; overflow-x: auto; font-size: 0.85em;"><code>'andrographis': {
    name: 'Andrographis paniculata',
    common: 'Kalmegh',
    compounds: [
        {
            name: 'Andrographolide',
            cid: '5318517',
            formula: 'C20H30O5',
            weight: '350.45',
            smiles: 'CC1=C[C@@H]2[C@](...)',
            bioavailability: 0.55,
            bbb: 'No',
            lipinski: 'No',
            drugLikeness: 0.42,
            hepatotoxicity: 'Inactive',
            carcinogenicity: 'Inactive',
            immunogenicity: 'Inactive',
            mutagenicity: 'Inactive',
            cytotoxicity: 'Inactive'
        },
        // ... add all compounds here
    ]
}
</code></pre>
                </div>

                <div style="background: #d1ecf1; padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #0dcaf0;">
                    <strong>üí° Tip:</strong> Use a Python script or Excel formula to convert CSV to JavaScript object format. You can also use online JSON converters and then format for JavaScript.
                </div>
            </div>

            <h3 style="margin: 30px 0 20px; color: var(--text-dark);">‚è±Ô∏è Time Estimation</h3>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 30px;">
                <div class="stats-box" style="background: var(--light-blue);">
                    <div class="stats-number" style="font-size: 2em;">2-4h</div>
                    <div class="stats-label">Steps 1-2: Compound Collection & PubChem (per 1000 compounds)</div>
                </div>
                <div class="stats-box" style="background: #fef3c7;">
                    <div class="stats-number" style="font-size: 2em; color: var(--warning-orange);">4-6h</div>
                    <div class="stats-label">Step 3-4: SwissADME & Lipinski (per 1000 compounds)</div>
                </div>
                <div class="stats-box" style="background: #fee2e2;">
                    <div class="stats-number" style="font-size: 2em; color: var(--danger-red);">8-10h</div>
                    <div class="stats-label">Step 5-6: Molsoft & ProTox-II (per 1000 compounds)</div>
                </div>
                <div class="stats-box" style="background: #dcfce7;">
                    <div class="stats-number" style="font-size: 2em; color: var(--success-green);">14-20h</div>
                    <div class="stats-label">Total per 1000 compounds (can be split over multiple days)</div>
                </div>
            </div>

            <div class="info-box" style="background: #fef3c7; border-left-color: var(--warning-orange);">
                <div class="info-title" style="color: var(--warning-orange);">‚ö†Ô∏è Important Considerations</div>
                <ul style="line-height: 2; margin-left: 20px; margin-top: 10px;">
                    <li>For 15 plants √ó 1000 compounds each = 15,000 compounds total</li>
                    <li>Estimated total time: 210-300 hours (can be parallelized across multiple researchers)</li>
                    <li>Consider collecting a representative sample first (e.g., 100-200 compounds per plant)</li>
                    <li>Some databases have usage limits - respect their terms of service</li>
                    <li>Always keep backup copies of your collected data</li>
                    <li>Document data sources and collection dates for your thesis</li>
                </ul>
            </div>

            <div style="text-align: center; margin-top: 40px;">
                <button class="btn btn-primary" onclick="navigateToSection('home')">‚Üê Back to Home</button>
            </div>
        </div>

        <!-- About Section -->
        <div id="about-section" class="content-section">
            <!-- *** UPDATED H2 *** -->
            <h2 style="color: var(--primary-blue); margin-bottom: 20px;">‚ÑπÔ∏è About DrugDiscovery 2.1</h2>
            
            <div class="info-box">
                <div class="info-title"> Project Background</div>
                <p>This enhanced platform was developed as part of a Master's thesis in Biotechnology at Berhampur University, focusing on computational approaches to plant-based drug discovery with emphasis on drug like compounds. Version 2.1 includes major performance optimizations and new features for handling large-scale datasets.</p>
            </div>

            <h3 style="margin: 30px 0 20px; color: var(--text-dark);">üÜï What's New in Version 2.1</h3>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
                <div style="background: var(--white); border-radius: 12px; padding: 20px; border: 2px solid var(--border-gray);">
                    <h4 style="color: var(--secondary-blue); margin-bottom: 10px;"> Performance</h4>
                    <ul style="line-height: 2; font-size: 0.9em;">
                        <li>Virtual scrolling for large datasets</li>
                        <li>Lazy loading of compound data</li>
                        <li>Optimized filtering algorithms</li>
                        <li>Indexed search functionality</li>
                    </ul>
                </div>
                <div style="background: var(--white); border-radius: 12px; padding: 20px; border: 2px solid var(--border-gray);">
                    <h4 style="color: var(--secondary-blue); margin-bottom: 10px;">üîç Search & Filter</h4>
                    <ul style="line-height: 2; font-size: 0.9em;">
                        <li>Real-time compound search</li>
                        <li>Filter presets (Permissive, Moderate, Strict)</li>
                        <li>Advanced filtering options</li>
                        <li>Molecular weight range filters</li>
                    </ul>
                </div>
                <div style="background: var(--white); border-radius: 12px; padding: 20px; border: 2px solid var(--border-gray);">
                    <h4 style="color: var(--secondary-blue); margin-bottom: 10px;">üìö Documentation</h4>
                    <ul style="line-height: 2; font-size: 0.9em;">
                        <li>Comprehensive data collection guide</li>
                        <li>Step-by-step database instructions</li>
                        <li>Python automation scripts</li>
                        <li>Time estimation for data collection</li>
                    </ul>
                </div>
                <div style="background: var(--white); border-radius: 12px; padding: 20px; border: 2px solid var(--border-gray);">
                    <h4 style="color: var(--secondary-blue); margin-bottom: 10px;">üé® User Experience</h4>
                    <ul style="line-height: 2; font-size: 0.9em;">
                        <li>Improved responsive design</li>
                        <li>Progress indicators</li>
                        <li>Enhanced visual feedback</li>
                        <li>Better mobile support</li>
                    </ul>
                </div>
            </div>

            <h3 style="margin: 30px 0 20px; color: var(--text-dark);">üî¨ Methodology</h3>
            
            <div style="background: var(--white); border-radius: 15px; padding: 25px; border: 2px solid var(--border-gray); margin-bottom: 20px;">
                <h4 style="color: var(--secondary-blue); margin-bottom: 15px;">Data Collection Pipeline</h4>
                <ol style="line-height: 2; color: var(--text-dark);">
                    <li><strong>Phytochemical Database Integration:</strong> Data sourced from IMPPAT 2.0, Dr. Duke's Phytochemical and Ethnobotanical Database, and KNApSAcK Family Database</li>
                    <li><strong>Compound Characterization:</strong> Chemical properties retrieved from PubChem (CID, SMILES, molecular weight, formula)</li>
                    <li><strong>ADME Profiling:</strong> Absorption, Distribution, Metabolism, and Excretion properties analyzed using SwissADME</li>
                    <li><strong>Drug-Likeness Assessment:</strong> Scoring based on Molsoft's drug-likeness calculator</li>
                    <li><strong>Toxicity Prediction:</strong> Five toxicity parameters evaluated using ProTox-II</li>
                    <li><strong>Multi-Criteria Screening:</strong> Compounds filtered based on Lipinski's Ro5, bioavailability, BBB permeability, and toxicity profiles</li>
                </ol>
            </div>

            <h3 style="margin: 30px 0 20px; color: var(--text-dark);">üåø Plant Database</h3>
            <div style="background: var(--white); border-radius: 15px; padding: 25px; border: 2px solid var(--border-gray);">
                <p style="margin-bottom: 15px; color: var(--text-dark);">Our database includes 17 medicinal plants with traditional medicinal properties:</p>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; margin-top: 20px;">
                    <div style="padding: 15px; background: var(--light-blue); border-radius: 8px;">
                        <strong>Andrographis paniculata</strong> (Kalmegh)
                    </div>
                    <div style="padding: 15px; background: var(--light-blue); border-radius: 8px;">
                        <strong>Curcuma longa</strong> (Turmeric)
                    </div>
                    <div style="padding: 15px; background: var(--light-blue); border-radius: 8px;">
                        <strong>Azadirachta indica</strong> (Neem)
                    </div>
                    <div style="padding: 15px; background: var(--light-blue); border-radius: 8px;">
                        <strong>Ocimum sanctum</strong> (Tulsi)
                    </div>
                    <div style="padding: 15px; background: var(--light-blue); border-radius: 8px;">
                        <strong>Withania somnifera</strong> (Ashwagandha)
                    </div>
                    <div style="padding: 15px; background: var(--light-blue); border-radius: 8px;">
                        <strong>Glycyrrhiza glabra</strong> (Licorice)
                    </div>
                    <div style="padding: 15px; background: var(--light-blue); border-radius: 8px;">
                        <strong>Zingiber officinale</strong> (Ginger)
                    </div>
                    <div style="padding: 15px; background: var(--light-blue); border-radius: 8px;">
                        <strong>Tinospora cordifolia</strong> (Guduchi)
                    </div>
                    <div style="padding: 15px; background: var(--light-blue); border-radius: 8px;">
                        <strong>Phyllanthus amarus</strong>
                    </div>
                    <div style="padding: 15px; background: var(--light-blue); border-radius: 8px;">
                        <strong>Berberis aristata</strong>
                    </div>
                    <div style="padding: 15px; background: var(--light-blue); border-radius: 8px;">
                        <strong>Scutellaria baicalensis</strong>
                    </div>
                    <div style="padding: 15px; background: var(--light-blue); border-radius: 8px;">
                        <strong>Punica granatum</strong> (Pomegranate)
                    </div>
                    <div style="padding: 15px; background: var(--light-blue); border-radius: 8px;">
                        <strong>Mimosa pudica</strong>
                    </div>
                    <div style="padding: 15px; background: var(--light-blue); border-radius: 8px;">
                        <strong>Plantago major</strong>
                    </div>
                    <div style="padding: 15px; background: var(--light-blue); border-radius: 8px;">
                        <strong>Acorus calamus</strong>
                    </div>
                    <div style="padding: 15px; background: var(--light-blue); border-radius: 8px;">
                        <strong>Nyctanthes arbor-tristis</strong>
                    </div>
                    <div style="padding: 15px; background: var(--light-blue); border-radius: 8px;">
                        <strong>Clitoria ternatea</strong>
                    </div>
                </div>
            </div>

            <h3 style="margin: 30px 0 20px; color: var(--text-dark);">üìö References & Resources</h3>
            <div style="background: var(--white); border-radius: 15px; padding: 25px; border: 2px solid var(--border-gray);">
                <ul style="line-height: 2.5; color: var(--text-dark);">
                    <li><strong>IMPPAT:</strong> Indian Medicinal Plants, Phytochemistry And Therapeutics</li>
                    <li><strong>PubChem:</strong> Open chemistry database by NCBI</li>
                    <li><strong>SwissADME:</strong> Free web tool for ADME parameters prediction</li>
                    <li><strong>Molsoft:</strong> Drug-likeness and molecular properties calculator</li>
                    <li><strong>ProTox-II:</strong> Prediction of toxicity of chemicals</li>
                    <li><strong>Lipinski's Rule of Five:</strong> Drug-likeness filter criteria</li>
                    <li><strong>KNApSAcK:</strong> Comprehensive species-metabolite relationship database</li>
                    <li><strong>Dr. Duke's Database:</strong> USDA phytochemical database</li>
                </ul>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <div class="footer-content">
                <!-- *** UPDATED H3 *** -->
                <h3 style="color: var(--primary-blue); margin-bottom: 15px;">DrugDiscovery 2.1</h3>
                <p style="color: var(--text-gray); margin-bottom: 10px;">
                    An optimized computational platform for plant-based drug discovery
                </p>
                <div style="margin: 15px 0;">
                    <span style="background: var(--success-green); color: white; padding: 5px 15px; border-radius: 20px; font-size: 0.9em; font-weight: 600;">Version 2.1 - Enhanced</span>
                </div>
                <div class="developer-info">
                    <p><strong>Developer:</strong> Biswaranjan Mahapatra</p>
                    <p><strong>Institution:</strong> Masters in Biotechnology, Berhampur University</p>
                    <p><strong>Email:</strong> <a href="mailto:biswar95@gmail.com" style="color: var(--secondary-blue); text-decoration: none;">biswar95@gmail.com</a></p>
                    <!-- *** UPDATED COPYRIGHT *** -->
                    <p style="margin-top: 15px; font-size: 0.9em;">¬© 2025 DrugDiscovery 2.1 | For Research & Educational Purposes</p>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script>
        // *** MODIFICATION START: EXPANDED plantDatabase WITH DEMO DATA ***
        
        // Helper function to create demo compounds
        function createDemoCompound(name, cid, formula, weight, smiles, qed, logP, hba, hbd) {
            return {
                name: name,
                cid: cid,
                formula: formula,
                weight: weight,
                smiles: smiles,
                bioavailability: Math.random() * (0.8 - 0.1) + 0.1, // Random demo val
                bbb: Math.random() > 0.5 ? 'Yes' : 'No',
                lipinski: Math.random() > 0.3 ? 'No with zero violation' : 'Yes with one violation',
                drugLikeness: Math.random() * (1.5 - (-1.5)) + (-1.5),
                hepatotoxicity: Math.random() > 0.7 ? 'Active' : 'Inactive',
                carcinogenicity: Math.random() > 0.8 ? 'Active' : 'Inactive',
                immunogenicity: Math.random() > 0.8 ? 'Active' : 'Inactive',
                mutagenicity: Math.random() > 0.8 ? 'Active' : 'Inactive',
                cytotoxicity: Math.random() > 0.7 ? 'Active' : 'Inactive',
                qed: qed,
                logP: logP,
                hba: hba,
                hbd: hbd
            };
        }

        // Enhanced Sample Database with more compounds
        const plantDatabase = {
            andrographis: {
        name: "Andrographis paniculata",
        common: "Kalmegh",
        compounds: [
            {
                name: "Andrographolide",
                cid: "5318517",
                formula: "C20H30O5",
                weight: 350.4,
                smiles: "C[C@@]12CC[C@H]([C@@]([C@H]1CCC(=C)[C@H]2C/C=C/3\\[C@@H](COC3=O)O)(C)CO)O",
                bioavailability: 0.55,
                bbb: "No",
                lipinski: "0",
                drugLikeness: 4.8,
                qed: 0.411,
                logP: 1.96,
                hbd: 3,
                hba: 5,
                hepatotoxicity: "Inactive",
                carcinogenicity: "Inactive",
                immunogenicity: "Active",
                mutagenicity: "Inactive",
                cytotoxicity: "Inactive"
            },
            {
                name: "Wogonin 5-glucoside",
                cid: "44258554",
                formula: "C22H22O10",
                weight: 446.4,
                smiles: "COC1=C2C(=C(C=C1O)O[C@H]3C([C@H]([C@@H](C(O3)CO)O)O)O)C(=O)C=C(O2)C4=CC=CC=C4",
                bioavailability: 0.55,
                bbb: "No",
                lipinski: "0",
                drugLikeness: 1.4,
                qed: 0.37,
                logP: 0.35,
                hbd: 5,
                hba: 10,
                hepatotoxicity: "Inactive",
                carcinogenicity: "Inactive",
                immunogenicity: "Active",
                mutagenicity: "Inactive",
                cytotoxicity: "Inactive"
            }
        ]
    },
            'curcuma': {
                name: 'Curcuma longa',
                common: 'Turmeric',
                compounds: [
                    /* UPDATED lipinski values in sample data */
                    /* ADDED 4 NEW PROPERTIES: qed, logP, hba, hbd */
                    { name: 'Curcumin', cid: '969516', formula: 'C21H20O6', weight: '368.38', smiles: 'COC1=C(C=CC(=C1)/C=C/C(=O)CC(=O)/C=C/C2=CC(=C(C=C2)O)OC)O', bioavailability: 0.05, bbb: 'No', lipinski: 'No with zero violation', drugLikeness: 0.15, hepatotoxicity: 'Inactive', carcinogenicity: 'Inactive', immunogenicity: 'Inactive', mutagenicity: 'Inactive', cytotoxicity: 'Inactive', qed: 0.53, logP: 3.2, hba: 6, hbd: 2 },
                    { name: 'Demethoxycurcumin', cid: '5469424', formula: 'C20H18O5', weight: '338.35', smiles: 'COC1=C(C=CC(=C1)/C=C/C(=O)CC(=O)/C=C/C2=CC=C(C=C2)O)O', bioavailability: 0.10, bbb: 'No', lipinski: 'No with zero violation', drugLikeness: 0.25, hepatotoxicity: 'Inactive', carcinogenicity: 'Inactive', immunogenicity: 'Inactive', mutagenicity: 'Inactive', cytotoxicity: 'Inactive', qed: 0.58, logP: 3.0, hba: 5, hbd: 2 },
                    { name: 'Bisdemethoxycurcumin', cid: '5315472', formula: 'C19H16O4', weight: '308.33', smiles: 'C1=CC(=CC=C1/C=C/C(=O)CC(=O)/C=C/C2=CC=C(C=C2)O)O', bioavailability: 0.12, bbb: 'No', lipinski: 'No with zero violation', drugLikeness: 0.31, hepatotoxicity: 'Inactive', carcinogenicity: 'Inactive', immunogenicity: 'Inactive', mutagenicity: 'Inactive', cytotoxicity: 'Inactive', qed: 0.62, logP: 2.8, hba: 4, hbd: 2 },
                    { name: 'Turmerone', cid: '558221', formula: 'C15H20O', weight: '216.32', smiles: 'CC1=CCC(C(=C1)C)/C(=O)/C=C(C)/C', bioavailability: 0.78, bbb: 'Yes', lipinski: 'No with zero violation', drugLikeness: 0.52, hepatotoxicity: 'Inactive', carcinogenicity: 'Inactive', immunogenicity: 'Inactive', mutagenicity: 'Inactive', cytotoxicity: 'Inactive', qed: 0.45, logP: 3.5, hba: 1, hbd: 0 },
                ]
            },
            // Note: The duplicate 'curcuma' entry was removed.
            
            // --- ADDING DEMO DATA FOR ALL OTHER PLANTS ---
            'azadirachta': {
                name: 'Azadirachta indica',
                common: 'Neem',
                compounds: [
                    createDemoCompound('Azadirachtin', '161986', 'C35H44O16', '720.7', '...', 0.15, 1.2, 16, 7),
                    createDemoCompound('Nimbin', '161864', 'C30H36O9', '540.6', '...', 0.35, 3.1, 9, 2),
                    createDemoCompound('Salannin', '161870', 'C34H44O9', '596.7', '...', 0.30, 3.5, 9, 2)
                ]
            },
            'ocimum': {
                name: 'Ocimum sanctum',
                common: 'Tulsi',
                compounds: [
                    createDemoCompound('Eugenol', '3314', 'C10H12O2', '164.2', '...', 0.55, 2.7, 2, 1),
                    createDemoCompound('Rosmarinic acid', '5281792', 'C18H16O8', '360.3', '...', 0.40, 1.6, 8, 4),
                    createDemoCompound('Oleanolic acid', '122421', 'C30H48O3', '456.7', '...', 0.70, 6.3, 3, 2)
                ]
            },
            'withania': {
                name: 'Withania somnifera',
                common: 'Ashwagandha',
                compounds: [
                    createDemoCompound('Withaferin A', '265237', 'C28H38O6', '470.6', '...', 0.62, 3.8, 6, 2),
                    createDemoCompound('Withanolide D', '11202860', 'C28H38O6', '470.6', '...', 0.59, 3.5, 6, 2)
                ]
            },
            'glycyrrhiza': {
                name: 'Glycyrrhiza glabra',
                common: 'Licorice',
                compounds: [
                    createDemoCompound('Glycyrrhizin', '14982', 'C42H62O16', '822.9', '...', 0.12, 1.9, 16, 8),
                    createDemoCompound('Glabridin', '124058', 'C20H20O4', '324.4', '...', 0.75, 4.2, 4, 2)
                ]
            },
            'zingiber': {
                name: 'Zingiber officinale',
                common: 'Ginger',
                compounds: [
                    createDemoCompound('Gingerol', '442785', 'C17H26O4', '294.4', '...', 0.68, 3.4, 4, 2),
                    createDemoCompound('Shogaol', '5281794', 'C17H24O3', '276.4', '...', 0.72, 3.9, 3, 1)
                ]
            },
            'tinospora': {
                name: 'Tinospora cordifolia',
                common: 'Guduchi',
                compounds: [
                    createDemoCompound('Tinosporide', '10200843', 'C15H18O6', '294.3', '...', 0.45, 1.5, 6, 2),
                    createDemoCompound('Berberine', '2353', 'C20H18NO4+', '336.4', '...', 0.22, 1.1, 4, 0)
                ]
            },
            'phyllanthus': {
                name: 'Phyllanthus amarus',
                common: '',
                compounds: [
                    createDemoCompound('Phyllanthin', '73441', 'C24H34O6', '418.5', '...', 0.63, 4.1, 6, 0),
                    createDemoCompound('Hypophyllanthin', '119047', 'C24H30O7', '430.5', '...', 0.58, 3.8, 7, 0)
                ]
            },
            'berberis': {
                name: 'Berberis aristata',
                common: '',
                compounds: [
                    createDemoCompound('Berberine', '2353', 'C20H18NO4+', '336.4', '...', 0.22, 1.1, 4, 0),
                    createDemoCompound('Palmatine', '19009', 'C21H22NO4+', '352.4', '...', 0.25, 1.3, 4, 0)
                ]
            },
            'scutellaria': {
                name: 'Scutellaria baicalensis',
                common: '',
                compounds: [
                    createDemoCompound('Baicalin', '64982', 'C21H18O11', '446.4', '...', 0.33, 1.2, 11, 6),
                    createDemoCompound('Wogonin', '5281716', 'C16H12O5', '284.3', '...', 0.55, 2.9, 5, 2)
                ]
            },
            'punica': {
                name: 'Punica granatum',
                common: 'Pomegranate',
                compounds: [
                    createDemoCompound('Ellagic acid', '5281855', 'C14H6O8', '302.2', '...', 0.38, 1.4, 8, 4),
                    createDemoCompound('Punicalagin', '161298', 'C48H28O30', '1084.7', '...', 0.05, -1.5, 30, 15)
                ]
            },
            'mimosa': {
                name: 'Mimosa pudica',
                common: '',
                compounds: [
                    createDemoCompound('Mimosine', '6857', 'C8H10N2O4', '198.2', '...', 0.48, -0.8, 6, 3),
                    createDemoCompound('Quercetin', '5280343', 'C15H10O7', '302.2', '...', 0.42, 1.8, 7, 5)
                ]
            },
            'plantago': {
                name: 'Plantago major',
                common: '',
                compounds: [
                    createDemoCompound('Aucubin', '72304', 'C15H22O9', '346.3', '...', 0.37, -0.5, 9, 5),
                    createDemoCompound('Baicalein', '5281605', 'C15H10O5', '270.2', '...', 0.51, 2.2, 5, 3)
                ]
            },
            'acorus': {
                name: 'Acorus calamus',
                common: '',
                compounds: [
                    createDemoCompound('Asarone', '7590', 'C12H16O3', '208.3', '...', 0.70, 3.1, 3, 0),
                    createDemoCompound('Eugenol', '3314', 'C10H12O2', '164.2', '...', 0.55, 2.7, 2, 1)
                ]
            },
            'Nyctanthes': {
                name: 'Nyctanthes arbor-tristis',
                common: '',
                compounds: [
                    createDemoCompound('Asarone', '7590', 'C12H16O3', '208.3', '...', 0.70, 3.1, 3, 0),
                    createDemoCompound('Eugenol', '3314', 'C10H12O2', '164.2', '...', 0.55, 2.7, 2, 1)
                ]
            },
            'Clitoria': {
                name: 'Clitoria ternatea',
                common: '',
                compounds: [
                    createDemoCompound('Asarone', '7590', 'C12H16O3', '208.3', '...', 0.70, 3.1, 3, 0),
                    createDemoCompound('Eugenol', '3314', 'C10H12O2', '164.2', '...', 0.55, 2.7, 2, 1)
                ]
            }
        };
        
        // *** MODIFICATION END ***

        const plants = [
            {id: 'andrographis', name: 'Andrographis paniculata', common: 'Kalmegh'},
            {id: 'curcuma', name: 'Curcuma longa', common: 'Turmeric'},
            {id: 'azadirachta', name: 'Azadirachta indica', common: 'Neem'},
            {id: 'ocimum', name: 'Ocimum sanctum', common: 'Tulsi'},
            {id: 'withania', name: 'Withania somnifera', common: 'Ashwagandha'},
            {id: 'glycyrrhiza', name: 'Glycyrrhiza glabra', common: 'Licorice'},
            {id: 'zingiber', name: 'Zingiber officinale', common: 'Ginger'},
            {id: 'tinospora', name: 'Tinospora cordifolia', common: 'Guduchi'},
            {id: 'phyllanthus', name: 'Phyllanthus amarus', common: ''},
            {id: 'berberis', name: 'Berberis aristata', common: ''},
            {id: 'scutellaria', name: 'Scutellaria baicalensis', common: ''},
            {id: 'punica', name: 'Punica granatum', common: 'Pomegranate'},
            {id: 'mimosa', name: 'Mimosa pudica', common: ''},
            {id: 'plantago', name: 'Plantago major', common: ''},
            {id: 'acorus', name: 'Acorus calamus', common: ''},
            {id: 'Nyctanthes', name: 'Nyctanthes arbor-tristis', common: ''},
            {id: 'Clitoria', name: 'Clitoria ternatea', common: ''}
        ];

        let selectedPlant = null;
        let currentCompounds = [];
        let filteredCompounds = [];
        let screeningChart = null;
        let currentPage = 1;
let searchResults = [];
let rowsPerPage = 50;
let currentPreset = 'moderate';
        // Navigation state management
let workflowState = {
    startDiscoveryClicked: false,
    plantSelected: false,
    dataExplored: false,
    screeningApplied: false
};

        // Search index for fast searching
        let searchIndex = [];

        // Filter presets
        const filterPresets = {
    permissive: {
        bbb: 'no',
        hepato: false,
        carcino: false,
        immuno: false,
        mutagen: false,
        cyto: false
    },
    moderate: {
        bbb: 'no',
        hepato: true,
        carcino: true,
        immuno: true,
        mutagen: true,
        cyto: true
    },
    strict: {
        bbb: 'no',
        hepato: true,
        carcino: true,
        immuno: true,
        mutagen: true,
        cyto: true
    }
};

        // Initialize
        window.onload = function() {
            initPlantGrid();
            buildSearchIndex();
            
            // Reset workflow state on page load
            workflowState = {
                startDiscoveryClicked: false,
                plantSelected: false,
                dataExplored: false,
                screeningApplied: false
            };
        };
        // Hash-based routing - ADD THIS NEW SECTION
const sectionMap = {
    'home': 'home-section',
    'select': 'select-section',
    'explore': 'explore-section',
    'screen': 'screen-section',
    'results': 'results-section',
    'guide': 'guide-section',
    'about': 'about-section'
};

function navigateToSection(sectionName) {
    window.location.hash = sectionName;
}

function handleHashChange() {
    let hash = window.location.hash.slice(1);
    if (!hash || !sectionMap[hash]) {
        hash = 'home';
        window.location.hash = 'home';
    }
    showSectionByHash(hash);
}

function showSectionByHash(hash) {
    const sectionId = sectionMap[hash];
    
    // Hide all sections
    document.querySelectorAll('.content-section').forEach(section => {
        section.classList.remove('active');
    });
    
    // Show target section
    const targetSection = document.getElementById(sectionId);
    if (targetSection) {
        targetSection.classList.add('active');
    }
    
    // Update nav tabs
    document.querySelectorAll('.nav-tab').forEach(tab => {
        tab.classList.remove('active');
        if (tab.getAttribute('data-section') === hash) {
            tab.classList.add('active');
        }
    });
    
    window.scrollTo(0, 0);
}

// Listen for hash changes
window.addEventListener('hashchange', handleHashChange);

// Add click listeners to nav tabs
document.querySelectorAll('.nav-tab').forEach(tab => {
    tab.addEventListener('click', function() {
        const section = this.getAttribute('data-section');
        navigateToSection(section);
    });
});

// Handle initial load
handleHashChange();

        // Build search index
        function buildSearchIndex() {
            searchIndex = [];
            for (let plantKey in plantDatabase) {
                const plant = plantDatabase[plantKey];
                if (plant.compounds) {
                    plant.compounds.forEach((compound, idx) => {
                        searchIndex.push({
                            plantKey: plantKey,
                            compoundIndex: idx,
                            searchText: `${compound.name} ${compound.cid} ${compound.formula} ${compound.smiles}`.toLowerCase()
                        });
                    });
                }
            }
        }
        // Start discovery workflow
        function startDiscovery() {
            workflowState.startDiscoveryClicked = true;
            navigateToSection('select');
            }

        // Proceed to screening workflow
        function proceedToScreening() {
            workflowState.dataExplored = true;
            navigateToSection('screen');
        }


        // Initialize plant grid
        function initPlantGrid() {
            const grid = document.getElementById('plantGrid');
            grid.innerHTML = plants.map(plant => {
                // *** MODIFICATION: Count compounds from the (now guaranteed) DB entry ***
                const compoundCount = plantDatabase[plant.id]?.compounds?.length || 0;
                return `
                    <div class="plant-card" onclick="selectPlant('${plant.id}', event)" data-plant-name="${plant.name.toLowerCase()}" data-common-name="${plant.common.toLowerCase()}">
                        <div class="plant-name">${plant.common || plant.name}</div>
                        <div class="plant-scientific">${plant.name}</div>
                        <div class="plant-compound-count">${compoundCount} compounds</div>
                    </div>
                `;
            }).join('');
        }

        // Filter plants in selection
        function filterPlants() {
            const searchTerm = document.getElementById('plantSearch').value.toLowerCase();
            const cards = document.querySelectorAll('.plant-card');
            
            cards.forEach(card => {
                const plantName = card.getAttribute('data-plant-name');
                const commonName = card.getAttribute('data-common-name');
                
                if (plantName.includes(searchTerm) || commonName.includes(searchTerm)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // Select plant with loading animation
        function selectPlant(plantId, event) {
            selectedPlant = plantId;
            currentPage = 1;
            
            document.querySelectorAll('.plant-card').forEach(card => card.classList.remove('selected'));
            if(event) {
                const cardElement = event.currentTarget;
                if(cardElement) cardElement.classList.add('selected');
            }

            const loadingScreen = document.getElementById('loadingScreen');
            const plantGrid = document.getElementById('plantGrid');
            
            loadingScreen.classList.add('active');
            plantGrid.style.display = 'none';
            
            // Simulate loading with progress bar
            let progress = 0;
            const progressBar = document.getElementById('loadingProgress');
            const interval = setInterval(() => {
                progress += 10;
                progressBar.style.width = progress + '%';
                if (progress >= 100) {
                    clearInterval(interval);
                    setTimeout(() => loadPlantData(plantId), 300);
                }
            }, 150);
        }

        // Load plant data
        function loadPlantData(plantId) {
            const plantInfo = plants.find(p => p.id === plantId);
            const plantData = plantDatabase[plantId];
            
            if (plantData && plantData.compounds && plantData.compounds.length > 0) {
                currentCompounds = plantData.compounds;
                searchResults = [...currentCompounds];
            } else {
                // Fallback for any potential mismatch
                currentCompounds = [];
                searchResults = [];
            }
            
            document.getElementById('explorePlantName').textContent = `${plantInfo.name} (${plantInfo.common || 'N/A'})`;
            document.getElementById('selectedPlantName').textContent = `${plantInfo.name} (${plantInfo.common || 'N/A'})`;
            document.getElementById('exploreTotalCompounds').textContent = currentCompounds.length;
            document.getElementById('exploreSearchResults').textContent = searchResults.length;

            document.getElementById('loadingScreen').classList.remove('active');
            document.getElementById('plantGrid').style.display = 'grid';
            document.getElementById('loadingProgress').style.width = '0%';

            // Apply moderate preset by default
            applyPreset('moderate');
            
            displayExploreTable();
                        //document.getElementById('exploreTab').style.display = 'block';
            
            // Mark plant as selected
            workflowState.plantSelected = true;
            
            navigateToSection('explore');
        }

        // Search compounds
        function searchCompounds() {
            const searchTerm = document.getElementById('compoundSearch').value.toLowerCase();
            
            if (searchTerm === '') {
                searchResults = [...currentCompounds];
            } else {
                searchResults = currentCompounds.filter(compound => {
                    const searchText = `${compound.name} ${compound.cid} ${compound.formula} ${compound.smiles}`.toLowerCase();
                    return searchText.includes(searchTerm);
                });
            }
            
            currentPage = 1;
            document.getElementById('exploreSearchResults').textContent = searchResults.length;
            displayExploreTable();
        }

        // Display explore table with virtual scrolling support
        function displayExploreTable() {
            const container = document.getElementById('exploreTableContainer');
            const paginationControls = document.getElementById('paginationControls');

            if (searchResults.length === 0) {
                container.innerHTML = `<p style="text-align: center; padding: 30px; color: var(--text-gray);">No compounds found. Try adjusting your search or filters.</p>`;
                paginationControls.style.display = 'none';
                return;
            }

            paginationControls.style.display = 'flex';
            
            const totalPages = Math.ceil(searchResults.length / rowsPerPage);
            const startIndex = (currentPage - 1) * rowsPerPage;
            const endIndex = startIndex + rowsPerPage;
            const pageCompounds = searchResults.slice(startIndex, endIndex);

            const tableHTML = `
                <table class="results-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>CID</th>
                            <th>Formula</th>
                            <th>Weight</th>
                            <th>SMILES</th> <!-- ADDED SMILES HEADER -->
                            <th>Bioavailability</th>
                            <th>BBB</th>
                            <th>Lipinski</th>
                            <th>Drug Likeness</th>
                            <!-- <th>Toxicity Status</th> REMOVED -->
                            <!-- ADDED 4 NEW HEADERS -->
                            <th>QED</th>
                            <th>logP</th>
                            <th>HBA</th>
                            <th>HBD</th>
                            <!-- ADDED 5 NEW TOXICITY HEADERS -->
                            <th>Hepatotoxicity</th>
                            <th>Carcinogenicity</th>
                            <th>Immunogenicity</th>
                            <th>Mutagenicity</th>
                            <th>Cytotoxicity</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${pageCompounds.map(c => {
                            // Removed old toxicity logic
                            
                            return `
                            <tr>
                                <td><strong>${c.name}</strong></td>
                                <td>${c.cid}</td>
                                <td>${c.formula}</td>
                                <td>${c.weight}</td>
                                <td>${c.smiles}</td> <!-- ADDED SMILES DATA -->
                                <td>${c.bioavailability.toFixed(2)}</td>
                                <td>${c.bbb}</td>
                                <!-- UPDATED Lipinski badge logic -->
<td><span class="badge ${c.lipinski === 0 || c.lipinski === '0' ? 'active' : 'inactive'}">${c.lipinski === 0 || c.lipinski === '0' ? 'Pass (0)' : 'Fail (' + c.lipinski + ')'}</span></td>                                <td>${c.drugLikeness.toFixed(2)}</td>
                                <!-- REMOVED old toxicity status cell -->
                                
                                <!-- ADDED 4 NEW CELLS -->
                                <td>${c.qed?.toFixed(2) || 'N/A'}</td>
                                <td>${c.logP?.toFixed(2) || 'N/A'}</td>
                                <td>${c.hba || 'N/A'}</td>
                                <td>${c.hbd || 'N/A'}</td>
                                
                                <!-- ADDED 5 NEW TOXICITY CELLS WITH BADGES -->
                                <td><span class="badge ${c.hepatotoxicity === 'Inactive' ? 'active' : 'inactive'}">${c.hepatotoxicity}</span></td>
                                <td><span class="badge ${c.carcinogenicity === 'Inactive' ? 'active' : 'inactive'}">${c.carcinogenicity}</span></td>
                                <td><span class="badge ${c.immunogenicity === 'Inactive' ? 'active' : 'inactive'}">${c.immunogenicity}</span></td>
                                <td><span class="badge ${c.mutagenicity === 'Inactive' ? 'active' : 'inactive'}">${c.mutagenicity}</span></td>
                                <td><span class="badge ${c.cytotoxicity === 'Inactive' ? 'active' : 'inactive'}">${c.cytotoxicity}</span></td>
                            </tr>
                        `}).join('')}
                    </tbody>
                </table>
            `;
            container.innerHTML = tableHTML;
            updatePaginationControls();
        }

        function updatePaginationControls() {
            const totalPages = Math.ceil(searchResults.length / rowsPerPage);
            const startIndex = (currentPage - 1) * rowsPerPage + 1;
            const endIndex = Math.min(currentPage * rowsPerPage, searchResults.length);
            
            document.getElementById('pageInfo').textContent = `Page ${currentPage} of ${totalPages}`;
            document.getElementById('rowRangeInfo').textContent = `Showing ${startIndex}-${endIndex} of ${searchResults.length} compounds`;
            
            document.getElementById('prevPageBtn').disabled = currentPage === 1;
            document.getElementById('nextPageBtn').disabled = currentPage === totalPages || totalPages === 0;
        }

        function prevPage() {
            if (currentPage > 1) {
                currentPage--;
                displayExploreTable();
            }
        }

        function nextPage() {
            const totalPages = Math.ceil(searchResults.length / rowsPerPage);
            if (currentPage < totalPages) {
                currentPage++;
                displayExploreTable();
            }
        }
        // Change rows per page
        function changeRowsPerPage() {
            const selector = document.getElementById('rowsPerPageSelect');
            rowsPerPage = parseInt(selector.value);
            currentPage = 1; // Reset to first page
            displayExploreTable();
        }

        // Apply filter preset
        function applyPreset(presetName) {
            currentPreset = presetName;
            
            // Update active button
            document.querySelectorAll('.preset-btn').forEach(btn => btn.classList.remove('active'));
            event?.target?.classList.add('active');
            
            if (presetName === 'custom') return;
            
            const preset = filterPresets[presetName];

// BBB filter only (bio and drug are now fixed)
document.querySelector(`input[name="bbb"][value="${preset.bbb}"]`).checked = true;

// Optional filters (all OFF for presets)
if (document.getElementById('mwSwitch')) document.getElementById('mwSwitch').checked = false;
if (document.getElementById('qedSwitch')) document.getElementById('qedSwitch').checked = false;
if (document.getElementById('logPSwitch')) document.getElementById('logPSwitch').checked = false;
if (document.getElementById('hbdSwitch')) document.getElementById('hbdSwitch').checked = false;
if (document.getElementById('hbaSwitch')) document.getElementById('hbaSwitch').checked = false;

// Toxicity filters
document.getElementById('hepatoSwitch').checked = preset.hepato;
document.getElementById('carcinoSwitch').checked = preset.carcino;
document.getElementById('immunoSwitch').checked = preset.immuno;
document.getElementById('mutagenSwitch').checked = preset.mutagen;
document.getElementById('cytoSwitch').checked = preset.cyto;

updateFilters();
        }

        // Update filters with STRICT SEQUENTIAL filtering
function updateFilters() {
    if (!currentCompounds || currentCompounds.length === 0) return;
     
    // Get filter states
    const bbbFilter = document.querySelector('input[name="bbb"]:checked').value;
    
    // Optional filters (OFF by default)
    const mwEnabled = document.getElementById('mwSwitch')?.checked || false;
    const qedEnabled = document.getElementById('qedSwitch')?.checked || false;
    const logPEnabled = document.getElementById('logPSwitch')?.checked || false;
    const hbdEnabled = document.getElementById('hbdSwitch')?.checked || false;
    const hbaEnabled = document.getElementById('hbaSwitch')?.checked || false;
    
    // Toxicity filters (always active)
    const noHepato = document.getElementById('hepatoSwitch').checked;
    const noCarcino = document.getElementById('carcinoSwitch').checked;
    const noImmuno = document.getElementById('immunoSwitch').checked;
    const noMutagen = document.getElementById('mutagenSwitch').checked;
    const noCyto = document.getElementById('cytoSwitch').checked;

    // STRICT SEQUENTIAL FILTERING
    let compounds = [...currentCompounds];
    let stageResults = {};
    
    // Stage 0: Total
    stageResults.total = compounds.length;
    
    // Stage 1: Bioavailability ‚â• 0.55 (FIXED)
    compounds = compounds.filter(c => c.bioavailability >= 0.55);
    stageResults.afterBio = compounds.length;
    
    // Stage 2: BBB Permeability
    if (bbbFilter === 'yes') {
        compounds = compounds.filter(c => c.bbb === 'Yes');
    } else if (bbbFilter === 'no') {
        compounds = compounds.filter(c => c.bbb === 'No');
    }
    stageResults.afterBBB = compounds.length;
    
    // Stage 3: Lipinski violations = 0 (ONLY)
    compounds = compounds.filter(c => {
        const lipinski = c.lipinski;
        // Check if it's numeric 0 or string "0"
        return lipinski === 0 || lipinski === '0';
    });
    stageResults.afterLipinski = compounds.length;
    
    // Stage 4: Drug Likeness ‚â• 3.5 (FIXED)
    compounds = compounds.filter(c => c.drugLikeness >= 3.5);
    stageResults.afterDrugLikeness = compounds.length;
    
    // Stage 5: Optional Filters (only if enabled)
    let optionalFiltersApplied = false;
    
    if (mwEnabled) {
        compounds = compounds.filter(c => {
            const weight = parseFloat(c.weight);
            return weight >= 150 && weight <= 500;
        });
        optionalFiltersApplied = true;
    }
    
    if (qedEnabled) {
        compounds = compounds.filter(c => {
            const qed = c.qed === 'N/A' || c.qed === null ? 0 : parseFloat(c.qed);
            return qed >= 0.60;
        });
        optionalFiltersApplied = true;
    }
    
    if (logPEnabled) {
        compounds = compounds.filter(c => {
            const logP = c.logP === 'N/A' || c.logP === null ? 0 : parseFloat(c.logP);
            return logP >= 1 && logP <= 3;
        });
        optionalFiltersApplied = true;
    }
    
    if (hbdEnabled) {
        compounds = compounds.filter(c => {
            const hbd = c.hbd === 'N/A' || c.hbd === null ? 0 : parseInt(c.hbd);
            return hbd <= 5;
        });
        optionalFiltersApplied = true;
    }
    
    if (hbaEnabled) {
        compounds = compounds.filter(c => {
            const hba = c.hba === 'N/A' || c.hba === null ? 0 : parseInt(c.hba);
            return hba <= 10;
        });
        optionalFiltersApplied = true;
    }
    
    stageResults.afterOptional = optionalFiltersApplied ? compounds.length : null;
    
    // Stage 6: Toxicity (ALL must be Inactive)
    compounds = compounds.filter(c => {
        if (noHepato && c.hepatotoxicity === 'Active') return false;
        if (noCarcino && c.carcinogenicity === 'Active') return false;
        if (noImmuno && c.immunogenicity === 'Active') return false;
        if (noMutagen && c.mutagenicity === 'Active') return false;
        if (noCyto && c.cytotoxicity === 'Active') return false;
        return true;
    });
    stageResults.afterToxicity = compounds.length;

    // Update global filtered compounds
    filteredCompounds = compounds;

    // Update UI stats
    document.getElementById('totalCompounds').textContent = currentCompounds.length;
    document.getElementById('filteredCompounds').textContent = filteredCompounds.length;
    const rate = currentCompounds.length > 0 ? 
        ((filteredCompounds.length / currentCompounds.length) * 100).toFixed(1) : 0;
    document.getElementById('successRate').textContent = rate + '%';

    // Update chart with stage results
    updateChart(stageResults);
}
// Update screening chart with SEQUENTIAL STAGES
function updateChart(stageResults) {
    const canvas = document.getElementById('screeningChart');
    const ctx = canvas.getContext('2d');
    
    if (screeningChart) {
        screeningChart.destroy();
    }

    // 1. Create "3D" Gradients
    // Blue Gradient (Standard bars)
    const gradientBlue = ctx.createLinearGradient(0, 0, 0, 400);
    gradientBlue.addColorStop(0, 'rgba(14, 165, 233, 1)');   // Deep Blue Top
    gradientBlue.addColorStop(0.6, 'rgba(56, 189, 248, 0.8)'); // Lighter Middle
    gradientBlue.addColorStop(1, 'rgba(56, 189, 248, 0.1)');   // Faded Bottom

    // Green Gradient (Final Success bar)
    const gradientGreen = ctx.createLinearGradient(0, 0, 0, 400);
    gradientGreen.addColorStop(0, 'rgba(22, 163, 74, 1)');
    gradientGreen.addColorStop(0.6, 'rgba(74, 222, 128, 0.8)');
    gradientGreen.addColorStop(1, 'rgba(74, 222, 128, 0.1)');

    const chartLabels = [];
    const chartData = [];

    // Prepare Data (Same logic as before)
    chartLabels.push('Total');
    chartData.push(stageResults.total);

    chartLabels.push('Bioavail.');
    chartData.push(stageResults.afterBio);

    chartLabels.push('BBB');
    chartData.push(stageResults.afterBBB);

    chartLabels.push('Lipinski');
    chartData.push(stageResults.afterLipinski);

    chartLabels.push('Drug-Like');
    chartData.push(stageResults.afterDrugLikeness);

    if (stageResults.afterOptional !== null) {
        chartLabels.push('Optional');
        chartData.push(stageResults.afterOptional);
    }

    chartLabels.push('Final');
    chartData.push(stageResults.afterToxicity);

    // 2. Render Modern Chart
    screeningChart = new Chart(canvas, {
        type: 'bar',
        data: {
            labels: chartLabels,
            datasets: [{
                label: 'Compounds Remaining',
                data: chartData,
                backgroundColor: function(context) {
                    // Logic: If it's the last bar, make it Green (Success)
                    const index = context.dataIndex;
                    const count = context.chart.data.labels.length;
                    return index === count - 1 ? gradientGreen : gradientBlue;
                },
                borderRadius: 15, // Rounded corners for "Capsule" look
                borderSkipped: false, // Rounds the bottom too (optional) or set to 'bottom'
                barPercentage: 0.6, // Thicker, chunkier bars
                categoryPercentage: 0.8
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { 
                legend: { display: false }, // Cleaner look
                tooltip: {
                    backgroundColor: 'rgba(15, 23, 42, 0.9)', // Dark tooltip
                    titleColor: '#fff',
                    padding: 12,
                    cornerRadius: 8,
                    displayColors: false,
                    callbacks: {
                        label: function(context) {
                            return ` Compounds: ${context.parsed.y}`;
                        }
                    }
                }
            },
            scales: { 
                y: { 
                    beginAtZero: true, 
                    border: { display: false },
                    grid: {
                        color: 'rgba(148, 163, 184, 0.1)', // Very faint grid
                        drawBorder: false,
                    },
                    ticks: {
                        color: '#64748b',
                        font: { family: 'Inter', weight: '600' }
                    }
                },
                x: {
                    grid: { display: false }, // No vertical lines
                    ticks: {
                        color: '#334155',
                        font: { family: 'Inter', weight: '600', size: 11 }
                    }
                }
            },
            animation: {
                duration: 1500,
                easing: 'easeOutQuart' // Smooth, slow 3D rise effect
            }
        }
    });
}

        // Show results
        function showResults() {
            if (!selectedPlant) {
                alert('Please select a plant and apply filters first.');
                return;
            }
            workflowState.screeningApplied = true;
            navigateToSection('results');
            displayResults();
        }

        // Display results table
        function displayResults() {
            document.getElementById('resultsTotal').textContent = currentCompounds.length;
            document.getElementById('resultsPassed').textContent = filteredCompounds.length;
            const tableHTML = `
                <div class="table-responsive-container">
                    <table class="results-table">
                        <thead>
                            <tr>
                                <th>Compound Name</th>
                                <th>PubChem CID</th>
                                <th>Formula</th>
                                <th>MW (g/mol)</th>
                                <th>Bioavailability</th>
                                <th>Drug Likeness</th>
                                <th>Lipinski</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${filteredCompounds.length > 0 ? filteredCompounds.map(compound => `
                                <tr>
                                    <td><strong>${compound.name}</strong></td>
                                    <td><a href="https://pubchem.ncbi.nlm.nih.gov/compound/${compound.cid}" target="_blank" style="color: var(--secondary-blue);">${compound.cid}</a></td>
                                    <td>${compound.formula}</td>
                                    <td>${compound.weight}</td>
                                    <td>${compound.bioavailability.toFixed(2)}</td>
                                    <td>${compound.drugLikeness.toFixed(2)}</td>
                                    <td><span class="badge ${compound.lipinski === 0 || compound.lipinski === '0' ? 'active' : 'inactive'}">${compound.lipinski === 0 || compound.lipinski === '0' ? 'Pass (0)' : 'Fail (' + compound.lipinski + ')'}</span></td>
                                </tr>
                            `).join('') : `<tr><td colspan="7" style="text-align:center; padding: 30px;">No compounds passed the screening criteria. Try adjusting the filters.</td></tr>`}
                        </tbody>
                    </table>
                </div>
            `;

            document.getElementById('resultsTableContainer').innerHTML = tableHTML;
        }

        // Export results to CSV
        function exportResults() {
            if (filteredCompounds.length === 0) {
                alert('No compounds in the results list to export.');
                return;
            }

            const headers = ['Compound Name', 'PubChem CID', 'Formula', 'Molecular Weight', 'SMILES', 
                            'Bioavailability', 'BBB Permeability', 'Lipinski Violations', 'Drug Likeness',
                            // ADDED 4 NEW HEADERS
                            'QED', 'logP', 'HBA', 'HBD',
                            'Hepatotoxicity', 'Carcinogenicity', 'Immunogenicity', 'Mutagenicity', 'Cytotoxicity'];
            
            let csvContent = headers.join(',') + '\n';
            
            filteredCompounds.forEach(compound => {
                const row = [
                    compound.name,
                    compound.cid,
                    compound.formula,
                    compound.weight,
                    `"${compound.smiles}"`,
                    compound.bioavailability,
                    compound.bbb,
                    compound.lipinski,
                    compound.drugLikeness,
                    // ADDED 4 NEW VALUES
                    compound.qed,
                    compound.logP,
                    compound.hba,
                    compound.hbd,
                    compound.hepatotoxicity,
                    compound.carcinogenicity,
                    compound.immunogenicity,
                    compound.mutagenicity,
                    compound.cytotoxicity
                ];
                csvContent += row.join(',') + '\n';
            });

            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `drug_discovery_results_${selectedPlant}_${new Date().toISOString().slice(0,10)}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        // Show section
       function showSection(sectionId, event) {
    // Always allow access to these sections
    const alwaysAccessible = ['home', 'guide', 'about'];
    
    // Check workflow restrictions
    if (!alwaysAccessible.includes(sectionId)) {
        if (sectionId === 'select' && !workflowState.startDiscoveryClicked) {
            alert('Please click "START DISCOVERY" button from the Home page first.');
            return;
        }
        if (sectionId === 'explore' && !workflowState.plantSelected) {
            alert('Please select a plant first from the "Select Plant" tab.');
            return;
        }
        if (sectionId === 'screen' && !workflowState.dataExplored) {
            alert('Please explore the data first. Visit "Explore Data" tab and proceed.');
            return;
        }
        if (sectionId === 'results' && !workflowState.screeningApplied) {
            alert('Please apply screening filters first from the "Screen Compounds" tab.');
            return;
        }
    }
    
    const tabs = document.querySelectorAll('.nav-tab');
    tabs.forEach(tab => tab.classList.remove('active'));
    
    if(event && event.currentTarget) {
        event.currentTarget.classList.add('active');
    } else {
        const tabMap = {'home': 0, 'select': 1, 'explore': 2, 'screen': 3, 'results': 4, 'guide': 5, 'about': 6};
        if(document.getElementById('exploreTab').style.display === 'none'){
            delete tabMap.explore;
            tabMap.screen = 2;
            tabMap.results = 3;
            tabMap.guide = 4;
            tabMap.about = 5;
        }
        if(tabs[tabMap[sectionId]]) tabs[tabMap[sectionId]].classList.add('active');
    }

    const sections = document.querySelectorAll('.content-section');
    sections.forEach(section => section.classList.remove('active'));
    const el = document.getElementById(sectionId);
    if(el) el.classList.add('active');
}
    </script>
    <script>
        const canvas = document.getElementById('molecular-canvas');
        const ctx = canvas.getContext('2d');
        let particlesArray;

        // Resize canvas
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            init();
        });

        // Create Particle Class
        class Particle {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;
                this.size = Math.random() * 2 + 1; // Molecule size
                this.speedX = (Math.random() * 1) - 0.5; // Slow float speed
                this.speedY = (Math.random() * 1) - 0.5;
            }
            update() {
                this.x += this.speedX;
                this.y += this.speedY;
                // Bounce off edges
                if (this.x > canvas.width || this.x < 0) this.speedX = -this.speedX;
                if (this.y > canvas.height || this.y < 0) this.speedY = -this.speedY;
            }
            draw() {
                ctx.fillStyle = '#0ea5e9'; // Primary Blue
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function init() {
            particlesArray = [];
            let numberOfParticles = (canvas.height * canvas.width) / 15000; // Density
            for (let i = 0; i < numberOfParticles; i++) {
                particlesArray.push(new Particle());
            }
        }

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            for (let i = 0; i < particlesArray.length; i++) {
                particlesArray[i].update();
                particlesArray[i].draw();
                connect(particlesArray[i], particlesArray);
            }
            requestAnimationFrame(animate);
        }

        // Draw lines (bonds) between close particles
        function connect(a, particles) {
            for (let b of particles) {
                let dx = a.x - b.x;
                let dy = a.y - b.y;
                let distance = (dx * dx + dy * dy);
                
                if (distance < (canvas.width/9) * (canvas.height/9)) {
                   let opacityValue = 1 - (distance / 20000);
                   ctx.strokeStyle = 'rgba(14, 165, 233,' + opacityValue + ')'; // Blue Bonds
                   ctx.lineWidth = 1;
                   ctx.beginPath();
                   ctx.moveTo(a.x, a.y);
                   ctx.lineTo(b.x, b.y);
                   ctx.stroke();
                }
            }
        }

        init();
        animate();
    </script>
</body>
</html>

